<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hai Hung Nguyen">
<meta name="dcterms.date" content="2023-10-11">

<title>Chess rating</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Chess ratings report_files/libs/clipboard/clipboard.min.js"></script>
<script src="Chess ratings report_files/libs/quarto-html/quarto.js"></script>
<script src="Chess ratings report_files/libs/quarto-html/popper.min.js"></script>
<script src="Chess ratings report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Chess ratings report_files/libs/quarto-html/anchor.min.js"></script>
<link href="Chess ratings report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Chess ratings report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Chess ratings report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Chess ratings report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Chess ratings report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#input-data" id="toc-input-data" class="nav-link" data-scroll-target="#input-data">Input Data</a>
  <ul class="collapse">
  <li><a href="#blitz-rating-2022" id="toc-blitz-rating-2022" class="nav-link" data-scroll-target="#blitz-rating-2022">Blitz Rating 2022</a></li>
  <li><a href="#rapid-rating-2022" id="toc-rapid-rating-2022" class="nav-link" data-scroll-target="#rapid-rating-2022">Rapid Rating 2022</a></li>
  <li><a href="#standard-2017---2022" id="toc-standard-2017---2022" class="nav-link" data-scroll-target="#standard-2017---2022">Standard 2017 - 2022</a></li>
  </ul></li>
  <li><a href="#rating-by-continents-in-standard-games" id="toc-rating-by-continents-in-standard-games" class="nav-link" data-scroll-target="#rating-by-continents-in-standard-games">Rating by Continents in Standard Games</a>
  <ul class="collapse">
  <li><a href="#rating-by-continent" id="toc-rating-by-continent" class="nav-link" data-scroll-target="#rating-by-continent">Rating by continent</a></li>
  </ul></li>
  <li><a href="#played-games-by-country" id="toc-played-games-by-country" class="nav-link" data-scroll-target="#played-games-by-country">Played games by country</a>
  <ul class="collapse">
  <li><a href="#player-rating-change-carlsen-magnus" id="toc-player-rating-change-carlsen-magnus" class="nav-link" data-scroll-target="#player-rating-change-carlsen-magnus">Player rating change (Carlsen Magnus)</a></li>
  </ul></li>
  <li><a href="#summary-of-data" id="toc-summary-of-data" class="nav-link" data-scroll-target="#summary-of-data">Summary of data</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data preparation</a>
  <ul class="collapse">
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data cleaning</a>
  <ul class="collapse">
  <li><a href="#data-preparation-1" id="toc-data-preparation-1" class="nav-link" data-scroll-target="#data-preparation-1">Data preparation</a></li>
  <li><a href="#country-code-correction" id="toc-country-code-correction" class="nav-link" data-scroll-target="#country-code-correction">Country code correction</a></li>
  <li><a href="#player-age" id="toc-player-age" class="nav-link" data-scroll-target="#player-age">Player Age</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul class="collapse">
  <li><a href="#player-performance-prediction-standard-games-magnus-carlson" id="toc-player-performance-prediction-standard-games-magnus-carlson" class="nav-link" data-scroll-target="#player-performance-prediction-standard-games-magnus-carlson">Player Performance Prediction Standard Games (Magnus Carlson)</a>
  <ul class="collapse">
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a></li>
  <li><a href="#evaluation-and-visualization-of-test-and-trained-data" id="toc-evaluation-and-visualization-of-test-and-trained-data" class="nav-link" data-scroll-target="#evaluation-and-visualization-of-test-and-trained-data">Evaluation and visualization of Test and Trained Data</a></li>
  <li><a href="#preditcion" id="toc-preditcion" class="nav-link" data-scroll-target="#preditcion">Preditcion</a></li>
  </ul></li>
  <li><a href="#player-segmentation-clustering" id="toc-player-segmentation-clustering" class="nav-link" data-scroll-target="#player-segmentation-clustering">Player Segmentation (Clustering)</a>
  <ul class="collapse">
  <li><a href="#cluster-0" id="toc-cluster-0" class="nav-link" data-scroll-target="#cluster-0">Cluster 0:</a></li>
  <li><a href="#cluster-1" id="toc-cluster-1" class="nav-link" data-scroll-target="#cluster-1">Cluster 1:</a></li>
  <li><a href="#cluster-2" id="toc-cluster-2" class="nav-link" data-scroll-target="#cluster-2">Cluster 2:</a></li>
  <li><a href="#cluster-3" id="toc-cluster-3" class="nav-link" data-scroll-target="#cluster-3">Cluster 3:</a></li>
  <li><a href="#cluster-4" id="toc-cluster-4" class="nav-link" data-scroll-target="#cluster-4">Cluster 4:</a></li>
  </ul></li>
  <li><a href="#rating-dynamics-trend-analysis" id="toc-rating-dynamics-trend-analysis" class="nav-link" data-scroll-target="#rating-dynamics-trend-analysis">Rating Dynamics (Trend analysis)</a>
  <ul class="collapse">
  <li><a href="#time-series-forecasting" id="toc-time-series-forecasting" class="nav-link" data-scroll-target="#time-series-forecasting">Time Series Forecasting</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion-and-recommendations" id="toc-conclusion-and-recommendations" class="nav-link" data-scroll-target="#conclusion-and-recommendations">Conclusion and Recommendations</a>
  <ul class="collapse">
  <li><a href="#key-findings" id="toc-key-findings" class="nav-link" data-scroll-target="#key-findings">Key Findings</a></li>
  <li><a href="#recommendations" id="toc-recommendations" class="nav-link" data-scroll-target="#recommendations">Recommendations</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chess rating</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Hai Hung Nguyen </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 11, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="motivation" class="level1">
<h1>Motivation</h1>
<p>The goal of this analysis is to provide foundational insights into the status and progress of chess players globally, as reflected in the official monthly chess player lists from December 2017 to December 2022 for standard gamemode and for rapid and blitz from January 2022 to December 2022. We aim to describe the landscape of player rankings and to identify significant patterns for player segmentation by titles, ratings, and geography. This report anticipates uncovering the dynamics of player performance, with special attention to the effects of the COVID-19 pandemic and the prevalence of online chess, to inform future predictions on player ratings and game participation.</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<p>Set of monthly <strong>chess rating</strong> tables from December 2017 to December 2022 for standard gamemode and from January to December 2022 for blitz and rapid.</p>
<p>This datasets comes from university Gitlab.</p>
<section id="input-data" class="level2">
<h2 class="anchored" data-anchor-id="input-data">Input Data</h2>
<p>The input data is a CSV file with the following columns:</p>
<ul>
<li><code>ID Number</code>: A unique identifier assigned to each player.</li>
<li><code>Name</code>: The full name of the player.</li>
<li><code>Fed</code>: Abbreviation for the player’s federation, which usually corresponds to their country of representation.</li>
<li><code>Sex</code>: The sex of the player, typically denoted by ‘M’ for male or ‘F’ for female.</li>
<li><code>Tit</code>: Denotes the general title the player holds, if any, such as GM (Grandmaster), which represents the highest achievement in chess.</li>
<li><code>WTit</code>: Indicates the woman-specific title held by the player, such as WGM (Woman Grandmaster).</li>
<li><code>OTit</code>: Represents any other title the player may hold outside of the standard or woman-specific titles, such as trainer or arbiter.</li>
<li><code>FOA</code>: Stands for title in online games, reflecting achievements in the digital arena of chess.</li>
<li><code>Rat</code>: The current rating of the player, which is a numerical measure of their performance in chess.</li>
<li><code>Gms</code>: The count of games played by the player in the previous month.</li>
<li><code>K</code>: The coefficient of development, which is a unit of rating change. This value is higher for newcomers and lower for established top players, reflecting the variability and stability of their ratings.</li>
<li><code>B-day</code>: The birth year of the player.</li>
<li><code>Flag</code>: A code indicating the player’s status, with ‘i’ signifying an inactive player.</li>
<li><code>Year</code>: The current year when the data was recorded.</li>
<li><code>Mon</code>: The current month when the data was recorded.</li>
</ul>
<p>Since all the data are “scattered”, it would be nice if we have all the files into one <code>DataFrame</code>. It will also be useful later on.</p>
<section id="blitz-rating-2022" class="level3">
<h3 class="anchored" data-anchor-id="blitz-rating-2022">Blitz Rating 2022</h3>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>directory <span class="op">=</span> <span class="st">'data</span><span class="ch">\\</span><span class="st">blitz'</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>df_list <span class="op">=</span> []</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> filename <span class="kw">in</span> os.listdir(directory):</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filename.endswith(<span class="st">'.csv'</span>): </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        file_path <span class="op">=</span> os.path.join(directory, filename)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        monthly_df <span class="op">=</span> pd.read_csv(file_path, delimiter<span class="op">=</span><span class="st">'|'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        df_list.append(monthly_df)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>blitz2022df <span class="op">=</span> pd.concat(df_list, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>blitz2022df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID Number</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Fed</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Tit</th>
<th data-quarto-table-cell-role="th">WTit</th>
<th data-quarto-table-cell-role="th">OTit</th>
<th data-quarto-table-cell-role="th">FOA</th>
<th data-quarto-table-cell-role="th">Rat</th>
<th data-quarto-table-cell-role="th">Gms</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">B-day</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Mon</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10207538</td>
<td>A E M, Doshtagir</td>
<td>BAN</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1860</td>
<td>0</td>
<td>20</td>
<td>1974</td>
<td>i</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10680810</td>
<td>A hamed Ashraf, Abdallah</td>
<td>EGY</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1741</td>
<td>0</td>
<td>20</td>
<td>2001</td>
<td>NaN</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5716373</td>
<td>A Rajah, Abdul Shukor</td>
<td>MAS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1873</td>
<td>0</td>
<td>20</td>
<td>0</td>
<td>i</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4804929</td>
<td>A-ALI, Sali Abbas Abdulzahra</td>
<td>IRQ</td>
<td>F</td>
<td>WFM</td>
<td>WFM</td>
<td>NaN</td>
<td>NaN</td>
<td>1695</td>
<td>9</td>
<td>20</td>
<td>2001</td>
<td>w</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5700230</td>
<td>A.B, Muhd Yusop</td>
<td>MAS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1528</td>
<td>0</td>
<td>20</td>
<td>1983</td>
<td>i</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1955709</td>
<td>34271228</td>
<td>Zyuzin, Andrey</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2131</td>
<td>0</td>
<td>20</td>
<td>1977</td>
<td>i</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1955710</td>
<td>34478620</td>
<td>Zyuzin, Boris</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1633</td>
<td>0</td>
<td>20</td>
<td>1963</td>
<td>i</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1955711</td>
<td>55755011</td>
<td>Zyuzina, Marina</td>
<td>RUS</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1261</td>
<td>0</td>
<td>40</td>
<td>2004</td>
<td>w</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1955712</td>
<td>21054274</td>
<td>Zywczak, Damian</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1387</td>
<td>0</td>
<td>20</td>
<td>1993</td>
<td>i</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1955713</td>
<td>1189980</td>
<td>Zywert, Kacper</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1607</td>
<td>0</td>
<td>20</td>
<td>1999</td>
<td>i</td>
<td>2022</td>
<td>12</td>
</tr>
</tbody>
</table>

<p>1955714 rows × 15 columns</p>
</div>
</div>
</div>
</section>
<section id="rapid-rating-2022" class="level3">
<h3 class="anchored" data-anchor-id="rapid-rating-2022">Rapid Rating 2022</h3>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>directory <span class="op">=</span> <span class="st">'data</span><span class="ch">\\</span><span class="st">rapid'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df_list <span class="op">=</span> []</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> filename <span class="kw">in</span> os.listdir(directory):</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filename.endswith(<span class="st">'.csv'</span>): </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        file_path <span class="op">=</span> os.path.join(directory, filename)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        monthly_df <span class="op">=</span> pd.read_csv(file_path, delimiter<span class="op">=</span><span class="st">'|'</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        df_list.append(monthly_df)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>rapid2022df <span class="op">=</span> pd.concat(df_list, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>rapid2022df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID Number</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Fed</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Tit</th>
<th data-quarto-table-cell-role="th">WTit</th>
<th data-quarto-table-cell-role="th">OTit</th>
<th data-quarto-table-cell-role="th">FOA</th>
<th data-quarto-table-cell-role="th">Rat</th>
<th data-quarto-table-cell-role="th">Gms</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">B-day</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Mon</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10245154</td>
<td>A B M Jobair, Hossain</td>
<td>BAN</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1599</td>
<td>0</td>
<td>20</td>
<td>1998</td>
<td>i</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10207538</td>
<td>A E M, Doshtagir</td>
<td>BAN</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1836</td>
<td>0</td>
<td>20</td>
<td>1974</td>
<td>i</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>55630910</td>
<td>A Flores, Ervin</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1176</td>
<td>0</td>
<td>20</td>
<td>2011</td>
<td>i</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5716365</td>
<td>A Hamid, Harman</td>
<td>MAS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1593</td>
<td>0</td>
<td>20</td>
<td>1970</td>
<td>i</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>10215727</td>
<td>A K M Jane, Alam</td>
<td>BAN</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1609</td>
<td>0</td>
<td>20</td>
<td>1969</td>
<td>i</td>
<td>2022</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2758106</td>
<td>1189980</td>
<td>Zywert, Kacper</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1576</td>
<td>0</td>
<td>20</td>
<td>1999</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2758107</td>
<td>21822468</td>
<td>Zywica, Adam</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1680</td>
<td>0</td>
<td>20</td>
<td>1990</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2758108</td>
<td>41818385</td>
<td>Zyzanski, Michal</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1249</td>
<td>6</td>
<td>40</td>
<td>2007</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2758109</td>
<td>21038473</td>
<td>Zyzanski, Sebastian</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1469</td>
<td>0</td>
<td>20</td>
<td>1976</td>
<td>i</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2758110</td>
<td>21857814</td>
<td>Zyznowska, Marianna</td>
<td>POL</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1072</td>
<td>0</td>
<td>40</td>
<td>2004</td>
<td>wi</td>
<td>2022</td>
<td>12</td>
</tr>
</tbody>
</table>

<p>2758111 rows × 15 columns</p>
</div>
</div>
</div>
</section>
<section id="standard-2017---2022" class="level3">
<h3 class="anchored" data-anchor-id="standard-2017---2022">Standard 2017 - 2022</h3>
<p>This time we will also have <code>DataFrame</code> also for each year. It may be useful later on.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>directory <span class="op">=</span> <span class="st">'data</span><span class="ch">\\</span><span class="st">standard'</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>all_files <span class="op">=</span> os.listdir(directory)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out the files 'standard_YYMM.csv'</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>standard_files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> all_files <span class="cf">if</span> f.startswith(<span class="st">'standard_'</span>) <span class="kw">and</span> f.endswith(<span class="st">'.csv'</span>)]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>standard_files.sort()</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>yearly_dfs <span class="op">=</span> {}</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> filename <span class="kw">in</span> standard_files:</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    year_fragment <span class="op">=</span> filename.split(<span class="st">'_'</span>)[<span class="dv">1</span>][:<span class="dv">2</span>]</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> <span class="st">'20'</span> <span class="op">+</span> year_fragment </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    filepath <span class="op">=</span> os.path.join(directory, filename)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(filepath, delimiter<span class="op">=</span><span class="st">'|'</span>, low_memory<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> year <span class="kw">not</span> <span class="kw">in</span> yearly_dfs:</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        yearly_dfs[year] <span class="op">=</span> [df]</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        yearly_dfs[year].append(df)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>standard_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year, dfs <span class="kw">in</span> yearly_dfs.items():</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    yearly_df <span class="op">=</span> pd.concat(dfs, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    yearly_dfs[year] <span class="op">=</span> yearly_df</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    standard_df <span class="op">=</span> pd.concat([standard_df, yearly_df], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>standard_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID Number</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Fed</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Tit</th>
<th data-quarto-table-cell-role="th">WTit</th>
<th data-quarto-table-cell-role="th">OTit</th>
<th data-quarto-table-cell-role="th">FOA</th>
<th data-quarto-table-cell-role="th">Rat</th>
<th data-quarto-table-cell-role="th">Gms</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">B-day</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Mon</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>644498</td>
<td>NaN</td>
<td>FRA</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2008</td>
<td>1</td>
<td>20</td>
<td>0</td>
<td>NaN</td>
<td>2017</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>20504578</td>
<td>NaN</td>
<td>MAW</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1617</td>
<td>0</td>
<td>40</td>
<td>0</td>
<td>NaN</td>
<td>2017</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>35077023</td>
<td>A Chakravarthy</td>
<td>IND</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1151</td>
<td>0</td>
<td>40</td>
<td>1986</td>
<td>i</td>
<td>2017</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>10207538</td>
<td>A E M, Doshtagir</td>
<td>BAN</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1840</td>
<td>0</td>
<td>40</td>
<td>1974</td>
<td>i</td>
<td>2017</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>10206612</td>
<td>A K M, Sourab</td>
<td>BAN</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1708</td>
<td>4</td>
<td>40</td>
<td>0</td>
<td>NaN</td>
<td>2017</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21495358</td>
<td>34190632</td>
<td>Zyubin, Sergey</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1884</td>
<td>0</td>
<td>40</td>
<td>1975</td>
<td>i</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21495359</td>
<td>55746969</td>
<td>Zyuganov, Igor</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1325</td>
<td>10</td>
<td>40</td>
<td>2010</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21495360</td>
<td>24232602</td>
<td>Zyuzev, Pavel</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1856</td>
<td>0</td>
<td>40</td>
<td>1993</td>
<td>i</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21495361</td>
<td>1189980</td>
<td>Zywert, Kacper</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1519</td>
<td>0</td>
<td>20</td>
<td>1999</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21495362</td>
<td>21857814</td>
<td>Zyznowska, Marianna</td>
<td>POL</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1150</td>
<td>0</td>
<td>40</td>
<td>2004</td>
<td>wi</td>
<td>2022</td>
<td>12</td>
</tr>
</tbody>
</table>

<p>21495363 rows × 15 columns</p>
</div>
</div>
</div>
<p>And for example year 2020</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>yearly_dfs[<span class="st">'2020'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID Number</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Fed</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Tit</th>
<th data-quarto-table-cell-role="th">WTit</th>
<th data-quarto-table-cell-role="th">OTit</th>
<th data-quarto-table-cell-role="th">FOA</th>
<th data-quarto-table-cell-role="th">Rat</th>
<th data-quarto-table-cell-role="th">Gms</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">B-day</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Mon</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25121731</td>
<td>A C J John</td>
<td>IND</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1063</td>
<td>0</td>
<td>40</td>
<td>1987</td>
<td>NaN</td>
<td>2020</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>35077023</td>
<td>A Chakravarthy</td>
<td>IND</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1151</td>
<td>0</td>
<td>40</td>
<td>1986</td>
<td>i</td>
<td>2020</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>10207538</td>
<td>A E M, Doshtagir</td>
<td>BAN</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1840</td>
<td>0</td>
<td>40</td>
<td>1974</td>
<td>i</td>
<td>2020</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>10680810</td>
<td>A hamed Ashraf, Abdallah</td>
<td>EGY</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1728</td>
<td>0</td>
<td>40</td>
<td>2001</td>
<td>NaN</td>
<td>2020</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5716365</td>
<td>A Hamid, Harman</td>
<td>MAS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NI</td>
<td>NaN</td>
<td>1325</td>
<td>0</td>
<td>40</td>
<td>1970</td>
<td>i</td>
<td>2020</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4323852</td>
<td>21836060</td>
<td>Zyto, Karol</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1272</td>
<td>0</td>
<td>40</td>
<td>2006</td>
<td>NaN</td>
<td>2020</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4323853</td>
<td>34190632</td>
<td>Zyubin, Sergey</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1884</td>
<td>0</td>
<td>40</td>
<td>1975</td>
<td>i</td>
<td>2020</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4323854</td>
<td>24232602</td>
<td>Zyuzev, Pavel</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1856</td>
<td>0</td>
<td>40</td>
<td>1993</td>
<td>NaN</td>
<td>2020</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4323855</td>
<td>1189980</td>
<td>Zywert, Kacper</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1565</td>
<td>0</td>
<td>20</td>
<td>1999</td>
<td>i</td>
<td>2020</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4323856</td>
<td>21857814</td>
<td>Zyznowska, Marianna</td>
<td>POL</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1150</td>
<td>0</td>
<td>40</td>
<td>2004</td>
<td>wi</td>
<td>2020</td>
<td>12</td>
</tr>
</tbody>
</table>

<p>4323857 rows × 15 columns</p>
</div>
</div>
</div>
<p>As we can see from the first look at the data, there are a lot of missing values, and also the amount of data is really big where the biggest <code>DataFrame</code> has <code>4323857</code> rows. ## Distribution of Rating for Players with Various Titles Let’s analyze how ratings are <strong>distributed</strong> among players with different titles such as GM, IM, FM, etc… across all gamemodes.</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>title_order <span class="op">=</span> [<span class="st">'GM'</span>, <span class="st">'IM'</span>, <span class="st">'FM'</span>, <span class="st">'CM'</span>, <span class="st">'WGM'</span>, <span class="st">'WIM'</span>, <span class="st">'WFM'</span>, <span class="st">'WCM'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df_filtered <span class="op">=</span> standard_df[standard_df[<span class="st">'Tit'</span>].notnull()]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, create the boxplot with the defined order and correct palette usage</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Tit'</span>, y<span class="op">=</span><span class="st">'Rat'</span>, data<span class="op">=</span>df_filtered, order<span class="op">=</span>title_order)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># hide the hue legend</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Ratings for Players with Various Titles of Standard'</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Title'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Rating'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-chess-boxplot-standard" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Chess%20ratings%20report_files/figure-html/fig-chess-boxplot-standard-output-1.png" width="614" height="457" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Box Plot of Chess Ratings by Title</figcaption>
</figure>
</div>
</div>
</div>
<p>Similarly, we can do this for blitz mode as well.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_filtered <span class="op">=</span> blitz2022df[blitz2022df[<span class="st">'Tit'</span>].notnull()]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, create the boxplot with the defined order and correct palette usage</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Tit'</span>, y<span class="op">=</span><span class="st">'Rat'</span>, data<span class="op">=</span>df_filtered, order<span class="op">=</span>title_order)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># hide the hue legend</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Ratings for Players with Various Titles of Blitz'</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Title'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Rating'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-7-output-1.png" width="614" height="457"></p>
</div>
</div>
<p>And for the standard games</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_filtered <span class="op">=</span> rapid2022df[rapid2022df[<span class="st">'Tit'</span>].notnull()]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, create the boxplot with the defined order and correct palette usage</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">'Tit'</span>, y<span class="op">=</span><span class="st">'Rat'</span>, data<span class="op">=</span>df_filtered, order<span class="op">=</span>title_order)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># hide the hue legend</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>plt.legend([],[], frameon<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Ratings for Players with Various Titles of Rapid'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Title'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Rating'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-8-output-1.png" width="614" height="457"></p>
</div>
</div>
<p>As we can see we have multiple title categories Grandmaster (GM), International Master (IM), Fide Master (FM), Candidate Master (CM), Woman Grandmaster (WGM), Woman International Master (WIM), Woman Fide Master (WFM), and Woman Candidate Master (WCM).</p>
<p>The central band inside of each box represent the median rating for each title.The position of the median varies across titles, with GMs having a noticeably higher median rating, indicative of their higher skill level.</p>
<p>Comparing the boxes, one can see that higher titles generally correspond to higher ratings. However, the overlap in IQRs between consecutive titles (e.g., IM and FM) indicates that there is a range where players of different titles have similar ratings.</p>
<p>The number of outliers for GMs and IMs is particularly high in the Standard format, which may reflect a more established rating system with a larger pool of historical data.</p>
<p>The boxes for women’s titles (WGM, WIM, WFM, WCM) are generally positioned lower on the rating scale than their open counterparts. This may reflect historical and social factors affecting the number of women in competitive chess and the opportunities available to them.</p>
<p>Also we can notice in Rapid and Blitz games that some Grandmasters are way bellow their counterparts average.</p>
</section>
</section>
<section id="rating-by-continents-in-standard-games" class="level2">
<h2 class="anchored" data-anchor-id="rating-by-continents-in-standard-games">Rating by Continents in Standard Games</h2>
<p>Now let’s analyze rating and played games by Country. For more interesting case we chose the standard games. ### Rating by country The ratings will be divided into intervals of 200.</p>
<p><strong>Logarithmic normalization</strong> We will use <strong>logarithmic normalization</strong>, beacuse the raw player counts span several orders of magnitude. By applying a logarithmic scale, we reduce the skewness of the data, enabling a more discernible comparison across federations and rating intervals.</p>
<p>The data is grouped by <code>Rating Interval</code> and <code>Fed</code> (Federation), and the counts are normalized within each federation. This normalization is achieved by dividing the count of players in each rating interval by the total count of players in that federation.</p>
<p>The minimum value (<code>vmin</code>) for the <code>LogNorm</code> is set to half the minimum non-zero count or a default of 0.01 if no non-zero counts are present, and the maximum value (vmax) is the maximum non-zero count. This choice of <code>vmin</code> and <code>vmax</code> ensures that all data points are included within the scale and that the color mapping reflects the distribution of values across several orders of magnitude.</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> LogNorm</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> standard_df[[<span class="st">'Rat'</span>, <span class="st">'Fed'</span>]].copy()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'Rat'</span>] <span class="op">=</span> pd.to_numeric(df_copy[<span class="st">'Rat'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>df_copy.dropna(subset<span class="op">=</span>[<span class="st">'Rat'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>min_rating <span class="op">=</span> np.floor(df_copy[<span class="st">'Rat'</span>].<span class="bu">min</span>() <span class="op">/</span> <span class="dv">100</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>max_rating <span class="op">=</span> np.ceil(df_copy[<span class="st">'Rat'</span>].<span class="bu">max</span>() <span class="op">/</span> <span class="dv">100</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> <span class="bu">range</span>(<span class="bu">int</span>(min_rating), <span class="bu">int</span>(max_rating) <span class="op">+</span> <span class="dv">1</span>, <span class="dv">200</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f'</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">199</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> bins[:<span class="op">-</span><span class="dv">1</span>]]  <span class="co"># Label for each interval</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'Rating Interval'</span>] <span class="op">=</span> pd.cut(df_copy[<span class="st">'Rat'</span>], bins<span class="op">=</span>bins, labels<span class="op">=</span>labels, right<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="op">=</span> df_copy.groupby([<span class="st">'Rating Interval'</span>, <span class="st">'Fed'</span>], observed<span class="op">=</span><span class="va">True</span>).size().reset_index(name<span class="op">=</span><span class="st">'Count'</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>heatmap_data[<span class="st">'Count'</span>] <span class="op">=</span> heatmap_data[<span class="st">'Count'</span>] <span class="op">/</span> heatmap_data.groupby(<span class="st">'Fed'</span>)[<span class="st">'Count'</span>].transform(<span class="st">'sum'</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>heatmap_data_pivot <span class="op">=</span> heatmap_data.pivot(index<span class="op">=</span><span class="st">'Rating Interval'</span>, columns<span class="op">=</span><span class="st">'Fed'</span>, values<span class="op">=</span><span class="st">'Count'</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>non_zero_counts <span class="op">=</span> heatmap_data_pivot.to_numpy().ravel()</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>non_zero_counts <span class="op">=</span> non_zero_counts[non_zero_counts <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>vmin <span class="op">=</span> np.<span class="bu">min</span>(non_zero_counts)<span class="op">/</span><span class="dv">2</span> <span class="cf">if</span> <span class="bu">len</span>(non_zero_counts) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="fl">0.01</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>vmax <span class="op">=</span> np.<span class="bu">max</span>(non_zero_counts)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">15</span>)) </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>sns.heatmap(heatmap_data_pivot, annot<span class="op">=</span><span class="va">False</span>, cmap<span class="op">=</span><span class="st">"viridis"</span>, </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>            norm<span class="op">=</span>LogNorm(vmin<span class="op">=</span>vmin, vmax<span class="op">=</span>vmax))</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Normalized Heatmap of Player Count by Rating Interval and Federation'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Federation'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Rating Interval'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>, fontsize<span class="op">=</span><span class="dv">12</span>)  <span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-9-output-1.png" width="3328" height="1231"></p>
</div>
</div>
<p>As we can see (or not see) from the heatmap, it is realy hard to read the heatmap, due to the large number of countries.</p>
<p>But we can notice the more the rating the less dense the map is. This should be somewhat logical, since the higher the rating, the more dificult it is.</p>
<p>Some countries exhibit distinct patterns, such as having a dense middle tier of players or a top-heavy distribution with a significant number of elite players. These patterns could be indicative of the developmental focus or competitive structure within those countries.</p>
<p>While parsing data i have noticed of some data irregularities which reflects on the heatmap:</p>
<ul>
<li>Bad country mapping
<ul>
<li><code>VNM</code> != <code>VIE</code></li>
<li><code>IND</code> != <code>Ind</code></li>
<li><code>MAW</code> != <code>MWI</code></li>
<li>And many more</li>
</ul></li>
<li>Missing values of rating</li>
</ul>
<p>Because of the iregularites let’s analyze top 10 countries with most players by their mean.</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>active_df <span class="op">=</span> standard_df[standard_df[<span class="st">'Flag'</span>] <span class="op">!=</span> <span class="st">'i'</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>active_df[<span class="st">'Rat'</span>] <span class="op">=</span> pd.to_numeric(active_df[<span class="st">'Rat'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>active_df <span class="op">=</span> active_df.dropna(subset<span class="op">=</span>[<span class="st">'Rat'</span>])</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>active_player_counts <span class="op">=</span> active_df[<span class="st">'Fed'</span>].value_counts()</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>top_10_active_federations <span class="op">=</span> active_player_counts.head(<span class="dv">10</span>).index</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>mean_ratings_top_10_active_feds <span class="op">=</span> active_df[active_df[<span class="st">'Fed'</span>].isin(top_10_active_federations)].groupby(<span class="st">'Fed'</span>)[<span class="st">'Rat'</span>].mean()</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>sorted_mean_ratings_top_10_active_feds <span class="op">=</span> mean_ratings_top_10_active_feds.sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>sorted_mean_ratings_top_10_active_feds.plot(kind<span class="op">=</span><span class="st">'bar'</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Top 10 Active Federations by Mean Rating'</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Federation'</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Mean Rating'</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)  <span class="co"># Rotate the x-axis labels for better readability</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout() </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Tomas Nguyen\AppData\Local\Temp\ipykernel_17424\3445084069.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  active_df['Rat'] = pd.to_numeric(active_df['Rat'], errors='coerce')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-10-output-2.png" width="950" height="566"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>active_player_counts <span class="op">=</span> active_df[<span class="st">'Fed'</span>].value_counts()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>top_10_active_federations <span class="op">=</span> active_player_counts.head(<span class="dv">10</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>top_10_active_federations.plot(kind<span class="op">=</span><span class="st">'pie'</span>, autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>, startangle<span class="op">=</span><span class="dv">140</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Player Count of Top 10 Active Federations'</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">''</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-11-output-1.png" width="611" height="631"></p>
</div>
</div>
<p>It should not be surprising that countries that appear on the chart include ESP (Spain), ITA (Italy), and RUS (Russia), all known for their rich chess traditions.</p>
<p>We can also see that Czech republic is highly placed, after Germany, which suggests that Chess in CZE is highly competetive and also CZE has a high player participation in chess. The mean might be also affected by the low player count of CZE in comparisson with the rest top 10 countries.</p>
<p>We can see the highest rating has Germany, even though their player count is significantly large. This showcases quality and also quantity of german chess players.</p>
<section id="rating-by-continent" class="level3">
<h3 class="anchored" data-anchor-id="rating-by-continent">Rating by continent</h3>
<p>As i metioned earlier, it would be great if we could aggregate the countries by their respective continent. Because of data iregularities by countries, the analysis cannot be accurate.</p>
<p>It is good to mention that we have on our planet countries, which are transcontinental, which means they are located on two different continents, to be more accurate, the countries are Russia and Turkey. But since the majority of the population lives in Europe, we will categorize them as European countries.</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>federation_to_continent <span class="op">=</span> {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AFG'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ALA'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ALB'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DZA'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ASM'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AND'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AGO'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AIA'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ATA'</span>: <span class="st">'Antarctica'</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ATG'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ARG'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ARM'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ABW'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AUS'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AUT'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AZE'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BHS'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BHR'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BGD'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BRB'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BLR'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BEL'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BLZ'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BEN'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BMU'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BTN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BOL'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BES'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BIH'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BWA'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BVT'</span>: <span class="st">'Antarctica'</span>,</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BRA'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IOT'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BRN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BGR'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BFA'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BDI'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CPV'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KHM'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CMR'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CAN'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CYM'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CAF'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TCD'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CHL'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CHN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CXR'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CCK'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">'COL'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">'COM'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">'COG'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">'COD'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">'COK'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CRI'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CIV'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HRV'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CUB'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CUW'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CYP'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CZE'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DNK'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DJI'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DMA'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DOM'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ECU'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">'EGY'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SLV'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GNQ'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ERI'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">'EST'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SWZ'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ETH'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FLK'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FRO'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FJI'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FIN'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FRA'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GUF'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PYF'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ATF'</span>: <span class="st">'Antarctica'</span>,</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GAB'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GMB'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GEO'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DEU'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GHA'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GIB'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GRC'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GRL'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GRD'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GLP'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GUM'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GTM'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GGY'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GIN'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GNB'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GUY'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HTI'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HMD'</span>: <span class="st">'Antarctica'</span>,</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VAT'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HND'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HKG'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HUN'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ISL'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IND'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IDN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IRN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IRQ'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IRL'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IMN'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ISR'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ITA'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>    <span class="st">'JAM'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>    <span class="st">'JPN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">'JEY'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">'JOR'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KAZ'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KEN'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KIR'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PRK'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KOR'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KWT'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KGZ'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LAO'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LVA'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LBN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LSO'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LBR'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LBY'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LIE'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LTU'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LUX'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MAC'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MDG'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MWI'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MYS'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MDV'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MLI'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MLT'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MHL'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MTQ'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MRT'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MUS'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MYT'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MEX'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FSM'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MDA'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MCO'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MNG'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MNE'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSR'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MAR'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MOZ'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MMR'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NAM'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NRU'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NPL'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NLD'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NCL'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NZL'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NIC'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NER'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NGA'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NIU'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NFK'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MKD'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MNP'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NOR'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>    <span class="st">'OMN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PAK'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PLW'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PSE'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PAN'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PNG'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PRY'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PER'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PHL'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PCN'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a>    <span class="st">'POL'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PRT'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PRI'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">'QAT'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">'REU'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ROU'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a>    <span class="st">'RUS'</span>: <span class="st">'Europe'</span>,  <span class="co"># Russia is transcontinental, but most of its population is in Europe.</span></span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a>    <span class="st">'RWA'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BLM'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SHN'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KNA'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LCA'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MAF'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SPM'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VCT'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WSM'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SMR'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a>    <span class="st">'STP'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SAU'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SEN'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SRB'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SYC'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SLE'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SGP'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SXM'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SVK'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SVN'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SLB'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SOM'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ZAF'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SGS'</span>: <span class="st">'Antarctica'</span>,</span>
<span id="cb12-210"><a href="#cb12-210" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SSD'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ESP'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LKA'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SDN'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SUR'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SJM'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-216"><a href="#cb12-216" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SWE'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-217"><a href="#cb12-217" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CHE'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SYR'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TWN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-220"><a href="#cb12-220" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TJK'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-221"><a href="#cb12-221" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TZA'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a>    <span class="st">'THA'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TLS'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TGO'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TKL'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TON'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-227"><a href="#cb12-227" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TTO'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-228"><a href="#cb12-228" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TUN'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-229"><a href="#cb12-229" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TUR'</span>: <span class="st">'Europe'</span>,  <span class="co"># Turkey is transcontinental, but most of its population is in Europe.</span></span>
<span id="cb12-230"><a href="#cb12-230" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TKM'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-231"><a href="#cb12-231" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TCA'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-232"><a href="#cb12-232" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TUV'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a>    <span class="st">'UGA'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-234"><a href="#cb12-234" aria-hidden="true" tabindex="-1"></a>    <span class="st">'UKR'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-235"><a href="#cb12-235" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ARE'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-236"><a href="#cb12-236" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GBR'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-237"><a href="#cb12-237" aria-hidden="true" tabindex="-1"></a>    <span class="st">'USA'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-238"><a href="#cb12-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">'UMI'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-239"><a href="#cb12-239" aria-hidden="true" tabindex="-1"></a>    <span class="st">'URY'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-240"><a href="#cb12-240" aria-hidden="true" tabindex="-1"></a>    <span class="st">'UZB'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-241"><a href="#cb12-241" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VUT'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-242"><a href="#cb12-242" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VEN'</span>: <span class="st">'South America'</span>,</span>
<span id="cb12-243"><a href="#cb12-243" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VNM'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-244"><a href="#cb12-244" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VGB'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-245"><a href="#cb12-245" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VIR'</span>: <span class="st">'North America'</span>,</span>
<span id="cb12-246"><a href="#cb12-246" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WLF'</span>: <span class="st">'Oceania'</span>,</span>
<span id="cb12-247"><a href="#cb12-247" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ESH'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-248"><a href="#cb12-248" aria-hidden="true" tabindex="-1"></a>    <span class="st">'YEM'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-249"><a href="#cb12-249" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ZMB'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-250"><a href="#cb12-250" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ZWE'</span>: <span class="st">'Africa'</span>,</span>
<span id="cb12-251"><a href="#cb12-251" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GER'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-252"><a href="#cb12-252" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SUI'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-253"><a href="#cb12-253" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KOS'</span>: <span class="st">'Europe'</span>,</span>
<span id="cb12-254"><a href="#cb12-254" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BAN'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-255"><a href="#cb12-255" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MAS'</span>: <span class="st">'Asia'</span>,</span>
<span id="cb12-256"><a href="#cb12-256" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MAW'</span>: <span class="st">'Africa'</span>,   <span class="co"># Assuming 'MAW' is meant to represent Malawi</span></span>
<span id="cb12-257"><a href="#cb12-257" aria-hidden="true" tabindex="-1"></a>    <span class="st">'DEN'</span>: <span class="st">'Europe'</span>,   <span class="co"># Denmark</span></span>
<span id="cb12-258"><a href="#cb12-258" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IRI'</span>: <span class="st">'Asia'</span>,     <span class="co"># Islamic Republic of Iran</span></span>
<span id="cb12-259"><a href="#cb12-259" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TAN'</span>: <span class="st">'Africa'</span>,   <span class="co"># Tanzania</span></span>
<span id="cb12-260"><a href="#cb12-260" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SCO'</span>: <span class="st">'Europe'</span>,   <span class="co"># Scotland (part of the UK, typically not listed separately in ISO country codes)</span></span>
<span id="cb12-261"><a href="#cb12-261" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NED'</span>: <span class="st">'Europe'</span>,   <span class="co"># Netherlands</span></span>
<span id="cb12-262"><a href="#cb12-262" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SRI'</span>: <span class="st">'Asia'</span>,     <span class="co"># Sri Lanka</span></span>
<span id="cb12-263"><a href="#cb12-263" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ENG'</span>: <span class="st">'Europe'</span>,   <span class="co"># England (part of the UK, typically not listed separately in ISO country codes)</span></span>
<span id="cb12-264"><a href="#cb12-264" aria-hidden="true" tabindex="-1"></a>    <span class="st">'URU'</span>: <span class="st">'South America'</span>, <span class="co"># Uruguay</span></span>
<span id="cb12-265"><a href="#cb12-265" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PLE'</span>: <span class="st">'Asia'</span>,     <span class="co"># Palestine</span></span>
<span id="cb12-266"><a href="#cb12-266" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PHI'</span>: <span class="st">'Asia'</span>,     <span class="co"># Philippines</span></span>
<span id="cb12-267"><a href="#cb12-267" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CHI'</span>: <span class="st">'South America'</span>, <span class="co"># Chile</span></span>
<span id="cb12-268"><a href="#cb12-268" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CRC'</span>: <span class="st">'North America'</span>, <span class="co"># Costa Rica (part of Central America, which is geopolitically North America)</span></span>
<span id="cb12-269"><a href="#cb12-269" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ESA'</span>: <span class="st">'North America'</span>, <span class="co"># El Salvador</span></span>
<span id="cb12-270"><a href="#cb12-270" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GRE'</span>: <span class="st">'Europe'</span>,   <span class="co"># Greece</span></span>
<span id="cb12-271"><a href="#cb12-271" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CRO'</span>: <span class="st">'Europe'</span>,   <span class="co"># Croatia</span></span>
<span id="cb12-272"><a href="#cb12-272" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ALG'</span>: <span class="st">'Africa'</span>,   <span class="co"># Algeria</span></span>
<span id="cb12-273"><a href="#cb12-273" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LBA'</span>: <span class="st">'Africa'</span>,   <span class="co"># Libya</span></span>
<span id="cb12-274"><a href="#cb12-274" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SUD'</span>: <span class="st">'Africa'</span>,   <span class="co"># Sudan</span></span>
<span id="cb12-275"><a href="#cb12-275" aria-hidden="true" tabindex="-1"></a>    <span class="st">'UAE'</span>: <span class="st">'Asia'</span>,     <span class="co"># United Arab Emirates</span></span>
<span id="cb12-276"><a href="#cb12-276" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MTN'</span>: <span class="st">'Africa'</span>,   <span class="co"># Mauritania</span></span>
<span id="cb12-277"><a href="#cb12-277" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PAR'</span>: <span class="st">'South America'</span>, <span class="co"># Paraguay</span></span>
<span id="cb12-278"><a href="#cb12-278" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NGR'</span>: <span class="st">'Africa'</span>,   <span class="co"># Nigeria</span></span>
<span id="cb12-279"><a href="#cb12-279" aria-hidden="true" tabindex="-1"></a>    <span class="st">'INA'</span>: <span class="st">'Asia'</span>,     <span class="co"># Indonesia</span></span>
<span id="cb12-280"><a href="#cb12-280" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SLO'</span>: <span class="st">'Europe'</span>,   <span class="co"># Slovenia</span></span>
<span id="cb12-281"><a href="#cb12-281" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ANG'</span>: <span class="st">'Africa'</span>,   <span class="co"># Angola</span></span>
<span id="cb12-282"><a href="#cb12-282" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BRU'</span>: <span class="st">'Asia'</span>,     <span class="co"># Brunei</span></span>
<span id="cb12-283"><a href="#cb12-283" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ZAM'</span>: <span class="st">'Africa'</span>,   <span class="co"># Zambia</span></span>
<span id="cb12-284"><a href="#cb12-284" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LAT'</span>: <span class="st">'Europe'</span>,   <span class="co"># Latvia</span></span>
<span id="cb12-285"><a href="#cb12-285" aria-hidden="true" tabindex="-1"></a>    <span class="st">'POR'</span>: <span class="st">'Europe'</span>,   <span class="co"># Portugal</span></span>
<span id="cb12-286"><a href="#cb12-286" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KUW'</span>: <span class="st">'Asia'</span>,     <span class="co"># Kuwait</span></span>
<span id="cb12-287"><a href="#cb12-287" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NCA'</span>: <span class="st">'North America'</span>, <span class="co"># Nicaragua (part of Central America, which is geopolitically North America)</span></span>
<span id="cb12-288"><a href="#cb12-288" aria-hidden="true" tabindex="-1"></a>    <span class="st">'RSA'</span>: <span class="st">'Africa'</span>,   <span class="co"># Republic of South Africa</span></span>
<span id="cb12-289"><a href="#cb12-289" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SEY'</span>: <span class="st">'Africa'</span>,   <span class="co"># Seychelles</span></span>
<span id="cb12-290"><a href="#cb12-290" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PUR'</span>: <span class="st">'North America'</span>, <span class="co"># Puerto Rico</span></span>
<span id="cb12-291"><a href="#cb12-291" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MRI'</span>: <span class="st">'Africa'</span>,   <span class="co"># Mauritius</span></span>
<span id="cb12-292"><a href="#cb12-292" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NEP'</span>: <span class="st">'Asia'</span>,     <span class="co"># Nepal</span></span>
<span id="cb12-293"><a href="#cb12-293" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ISV'</span>: <span class="st">'North America'</span>, <span class="co"># United States Virgin Islands</span></span>
<span id="cb12-294"><a href="#cb12-294" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WLS'</span>: <span class="st">'Europe'</span>,   <span class="co"># Wales (part of the UK, typically not listed separately in ISO country codes)</span></span>
<span id="cb12-295"><a href="#cb12-295" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FID'</span>: <span class="st">'Oceania'</span>,  <span class="co"># Fiji (assuming 'FID' is a typo of 'FIJ')</span></span>
<span id="cb12-296"><a href="#cb12-296" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FIJ'</span>: <span class="st">'Oceania'</span>,  <span class="co"># Fiji</span></span>
<span id="cb12-297"><a href="#cb12-297" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MGL'</span>: <span class="st">'Asia'</span>,     <span class="co"># Mongolia</span></span>
<span id="cb12-298"><a href="#cb12-298" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HAI'</span>: <span class="st">'North America'</span>, <span class="co"># Haiti</span></span>
<span id="cb12-299"><a href="#cb12-299" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TOG'</span>: <span class="st">'Africa'</span>,   <span class="co"># Togo</span></span>
<span id="cb12-300"><a href="#cb12-300" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SOL'</span>: <span class="st">'Oceania'</span>,  <span class="co"># Solomon Islands</span></span>
<span id="cb12-301"><a href="#cb12-301" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KSA'</span>: <span class="st">'Asia'</span>,     <span class="co"># Kingdom of Saudi Arabia</span></span>
<span id="cb12-302"><a href="#cb12-302" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BOT'</span>: <span class="st">'Africa'</span>,   <span class="co"># Botswana</span></span>
<span id="cb12-303"><a href="#cb12-303" aria-hidden="true" tabindex="-1"></a>    <span class="st">'OMA'</span>: <span class="st">'Asia'</span>,     <span class="co"># Oman</span></span>
<span id="cb12-304"><a href="#cb12-304" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ZIM'</span>: <span class="st">'Africa'</span>,   <span class="co"># Zimbabwe</span></span>
<span id="cb12-305"><a href="#cb12-305" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GUA'</span>: <span class="st">'North America'</span>, <span class="co"># Guatemala</span></span>
<span id="cb12-306"><a href="#cb12-306" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MAD'</span>: <span class="st">'Africa'</span>,   <span class="co"># Madagascar</span></span>
<span id="cb12-307"><a href="#cb12-307" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BAR'</span>: <span class="st">'North America'</span>, <span class="co"># Barbados</span></span>
<span id="cb12-308"><a href="#cb12-308" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HON'</span>: <span class="st">'North America'</span>, <span class="co"># Honduras</span></span>
<span id="cb12-309"><a href="#cb12-309" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BER'</span>: <span class="st">'North America'</span>, <span class="co"># Bermuda</span></span>
<span id="cb12-310"><a href="#cb12-310" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VIE'</span>: <span class="st">'Asia'</span>,     <span class="co"># Vietnam</span></span>
<span id="cb12-311"><a href="#cb12-311" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FAI'</span>: <span class="st">'Europe'</span>,   <span class="co"># Faroe Islands</span></span>
<span id="cb12-312"><a href="#cb12-312" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MNC'</span>: <span class="st">'Europe'</span>,   <span class="co"># Monaco</span></span>
<span id="cb12-313"><a href="#cb12-313" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ARU'</span>: <span class="st">'North America'</span>, <span class="co"># Aruba</span></span>
<span id="cb12-314"><a href="#cb12-314" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MYA'</span>: <span class="st">'Asia'</span>,     <span class="co"># Myanmar</span></span>
<span id="cb12-315"><a href="#cb12-315" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TPE'</span>: <span class="st">'Asia'</span>,     <span class="co"># Chinese Taipei (Taiwan)</span></span>
<span id="cb12-316"><a href="#cb12-316" aria-hidden="true" tabindex="-1"></a>    <span class="st">'JCI'</span>: <span class="st">'Asia'</span>,     <span class="co"># Not a standard code, may need clarification</span></span>
<span id="cb12-317"><a href="#cb12-317" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GAM'</span>: <span class="st">'Africa'</span>,   <span class="co"># The Gambia</span></span>
<span id="cb12-318"><a href="#cb12-318" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LES'</span>: <span class="st">'Africa'</span>,   <span class="co"># Lesotho</span></span>
<span id="cb12-319"><a href="#cb12-319" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CGO'</span>: <span class="st">'Africa'</span>,   <span class="co"># Republic of the Congo</span></span>
<span id="cb12-320"><a href="#cb12-320" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GCI'</span>: <span class="st">'Europe'</span>,   <span class="co"># Not a standard code, may need clarification</span></span>
<span id="cb12-321"><a href="#cb12-321" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AHO'</span>: <span class="st">'North America'</span>, <span class="co"># Former code for Netherlands Antilles, now dissolved</span></span>
<span id="cb12-322"><a href="#cb12-322" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BUR'</span>: <span class="st">'Africa'</span>,   <span class="co"># Burkina Faso</span></span>
<span id="cb12-323"><a href="#cb12-323" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BHU'</span>: <span class="st">'Asia'</span>,     <span class="co"># Bhutan</span></span>
<span id="cb12-324"><a href="#cb12-324" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IVB'</span>: <span class="st">'North America'</span>, <span class="co"># British Virgin Islands</span></span>
<span id="cb12-325"><a href="#cb12-325" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BAH'</span>: <span class="st">'North America'</span>, <span class="co"># Bahamas</span></span>
<span id="cb12-326"><a href="#cb12-326" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CAM'</span>: <span class="st">'Asia'</span>,     <span class="co"># Cambodia</span></span>
<span id="cb12-327"><a href="#cb12-327" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Ind'</span>: <span class="st">'Asia'</span>,     <span class="co"># India (assuming 'Ind' is meant to represent India)</span></span>
<span id="cb12-328"><a href="#cb12-328" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ANT'</span>: <span class="st">'North America'</span>, <span class="co"># Antigua and Barbuda</span></span>
<span id="cb12-329"><a href="#cb12-329" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BUL'</span>: <span class="st">'Europe'</span>,   <span class="co"># Bulgaria</span></span>
<span id="cb12-330"><a href="#cb12-330" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CAY'</span>: <span class="st">'North America'</span>, <span class="co"># Cayman Islands</span></span>
<span id="cb12-331"><a href="#cb12-331" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IOM'</span>: <span class="st">'Europe'</span>,   <span class="co"># Isle of Man</span></span>
<span id="cb12-332"><a href="#cb12-332" aria-hidden="true" tabindex="-1"></a>    <span class="st">'VIN'</span>: <span class="st">'North America'</span>, <span class="co"># Saint Vincent and the Grenadines</span></span>
<span id="cb12-333"><a href="#cb12-333" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CHA'</span>: <span class="st">'Asia'</span>,     <span class="co"># Not a standard code, may need clarification</span></span>
<span id="cb12-334"><a href="#cb12-334" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GEQ'</span>: <span class="st">'Africa'</span>,   <span class="co"># Equatorial Guinea</span></span>
<span id="cb12-335"><a href="#cb12-335" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SKN'</span>: <span class="st">'North America'</span>, <span class="co"># Saint Kitts and Nevis</span></span>
<span id="cb12-336"><a href="#cb12-336" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> standard_df[[<span class="st">'Rat'</span>, <span class="st">'Fed'</span>]].copy()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'Rat'</span>] <span class="op">=</span> pd.to_numeric(df_copy[<span class="st">'Rat'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>df_copy.dropna(subset<span class="op">=</span>[<span class="st">'Rat'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'Continent'</span>] <span class="op">=</span> df_copy[<span class="st">'Fed'</span>].<span class="bu">map</span>(federation_to_continent)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>min_rating <span class="op">=</span> np.floor(df_copy[<span class="st">'Rat'</span>].<span class="bu">min</span>() <span class="op">/</span> <span class="dv">100</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>max_rating <span class="op">=</span> np.ceil(df_copy[<span class="st">'Rat'</span>].<span class="bu">max</span>() <span class="op">/</span> <span class="dv">100</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> <span class="bu">range</span>(<span class="bu">int</span>(min_rating), <span class="bu">int</span>(max_rating) <span class="op">+</span> <span class="dv">1</span>, <span class="dv">200</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f'</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">199</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> bins[:<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'Rating Interval'</span>] <span class="op">=</span> pd.cut(df_copy[<span class="st">'Rat'</span>], bins<span class="op">=</span>bins, labels<span class="op">=</span>labels, right<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="op">=</span> df_copy.groupby([<span class="st">'Rating Interval'</span>, <span class="st">'Continent'</span>], observed<span class="op">=</span><span class="va">True</span>).size().reset_index(name<span class="op">=</span><span class="st">'Count'</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>heatmap_data_pivot_continent <span class="op">=</span> heatmap_data.pivot(index<span class="op">=</span><span class="st">'Rating Interval'</span>, columns<span class="op">=</span><span class="st">'Continent'</span>, values<span class="op">=</span><span class="st">'Count'</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>sns.heatmap(heatmap_data_pivot_continent, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">"viridis"</span>, fmt<span class="op">=</span><span class="st">"g"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Heatmap of Player Count by Rating Interval and Continent'</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Continent'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Rating Interval'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>plt.yticks(rotation<span class="op">=</span><span class="dv">0</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-13-output-1.png" width="970" height="768"></p>
</div>
</div>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of players per continent</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>continent_counts <span class="op">=</span> df_copy[<span class="st">'Continent'</span>].value_counts()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of players per federation</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>federation_counts <span class="op">=</span> df_copy[<span class="st">'Fed'</span>].value_counts()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the pie chart for continents</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.pie(continent_counts, labels<span class="op">=</span>continent_counts.index, autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>, startangle<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Players per Continent'</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-14-output-1.png" width="479" height="409"></p>
</div>
</div>
<p>Europe has the highest concentration of players across all rating intervals, with particularly significant numbers in the 1400-1599 and 1600-1799 brackets, indicating a robust player base that spans from amateur to advanced levels. Asia also shows a strong presence, especially in the mid to high rating intervals (1600-2399), suggesting a competitive environment with a considerable number of skilled players.</p>
<p>As expected, there is a general decline in player count as the ratings increase, which is consistent across all continents. This trend is indicative of the increasing difficulty in achieving higher ratings.</p>
<p>The other continents, while having smaller player populations, contribute to the global diversity of the player base.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> standard_df[[<span class="st">'Rat'</span>, <span class="st">'Fed'</span>]].copy()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'Rat'</span>] <span class="op">=</span> pd.to_numeric(df_copy[<span class="st">'Rat'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df_copy.dropna(subset<span class="op">=</span>[<span class="st">'Rat'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">'Continent'</span>] <span class="op">=</span> df_copy[<span class="st">'Fed'</span>].<span class="bu">map</span>(federation_to_continent)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>average_rating_by_continent <span class="op">=</span> df_copy.groupby(<span class="st">'Continent'</span>)[<span class="st">'Rat'</span>].mean().reset_index()</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>average_rating_by_continent.sort_values(<span class="st">'Rat'</span>, ascending<span class="op">=</span><span class="va">False</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the matplotlib figure</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>sns.barplot(</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'Rat'</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Continent'</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>average_rating_by_continent,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    palette<span class="op">=</span><span class="st">'viridis'</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    hue<span class="op">=</span><span class="st">'Continent'</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="va">False</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels and title</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Average Rating'</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Continent'</span>)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Average Player Rating by Continent'</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-15-output-1.png" width="889" height="523"></p>
</div>
</div>
<p>While Europe dominates in player count, when looking at the average rating, North America leads, suggesting a higher overall player skill level or stronger competitive scene. It’s important to consider that these averages do not provide information on the distribution of ratings within each continent. For example, a continent could have a high average rating due to a small number of very highly rated players, while the majority of players have lower ratings.</p>
</section>
</section>
<section id="played-games-by-country" class="level2">
<h2 class="anchored" data-anchor-id="played-games-by-country">Played games by country</h2>
<p>Let’s analyze played games by country. Since we have a lot of countries, we will show only top 25 countries with the highest games played for year 2022.</p>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>blitz_games_by_country <span class="op">=</span> blitz2022df.groupby(<span class="st">'Fed'</span>)[<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>rapid_games_by_country <span class="op">=</span> rapid2022df.groupby(<span class="st">'Fed'</span>)[<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>standard_games_by_country <span class="op">=</span> yearly_dfs[<span class="st">'2022'</span>].groupby(<span class="st">'Fed'</span>)[<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>games_by_country_2022 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Blitz'</span>: blitz_games_by_country,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Rapid'</span>: rapid_games_by_country,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Standard'</span>: standard_games_by_country</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>}).fillna(<span class="dv">0</span>)  <span class="co"># Fill NaN with 0</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>games_by_country_2022[<span class="st">'Total Games'</span>] <span class="op">=</span> games_by_country_2022.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>top_10_countries_by_games <span class="op">=</span> games_by_country_2022[<span class="st">'Total Games'</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">25</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>top_10_countries_data <span class="op">=</span> games_by_country_2022.loc[top_10_countries_by_games.index]</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>top_10_countries_data[[<span class="st">'Blitz'</span>, <span class="st">'Rapid'</span>, <span class="st">'Standard'</span>]].plot(kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Top 10 Countries by Total Games Played in 2022'</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Country'</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Games'</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Game Mode'</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)  <span class="co"># Rotate the x-axis labels for better readability</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Adjust layout</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-16-output-1.png" width="950" height="566"></p>
</div>
</div>
<p>We can see that Blitz games are not that very popular amongst the countries, for example in <code>USA</code> or <code>ITA</code>. Standar games is the most popular gamemode accross.</p>
<p>Even though standard gamemode is popular, in some countries can be comparable to other gamememodes for example in <code>LTU</code> or in <code>EGY</code>.<br>
### Corelation between player count and games played</p>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of unique players per country for each dataset</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>blitz_player_count <span class="op">=</span> blitz2022df.groupby(<span class="st">'Fed'</span>)[<span class="st">'ID Number'</span>].nunique()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>rapid_player_count <span class="op">=</span> rapid2022df.groupby(<span class="st">'Fed'</span>)[<span class="st">'ID Number'</span>].nunique()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>standard_player_count <span class="op">=</span> yearly_dfs[<span class="st">'2022'</span>].groupby(<span class="st">'Fed'</span>)[<span class="st">'ID Number'</span>].nunique()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the player counts</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>total_player_count <span class="op">=</span> blitz_player_count.add(rapid_player_count, fill_value<span class="op">=</span><span class="dv">0</span>).add(standard_player_count, fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge this with your games_by_country_2022 DataFrame</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>games_by_country_2022[<span class="st">'Total Players'</span>] <span class="op">=</span> total_player_count</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the correlation</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>correlation <span class="op">=</span> games_by_country_2022[[<span class="st">'Total Games'</span>, <span class="st">'Total Players'</span>]].corr()</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Correlation between Total Games and Total Players:\n", correlation)</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter Plot</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>plt.scatter(games_by_country_2022[<span class="st">'Total Players'</span>], games_by_country_2022[<span class="st">'Total Games'</span>])</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation between Number of Players and Total Games by Country'</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Total Players'</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Total Games'</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-17-output-1.png" width="632" height="449"></p>
</div>
</div>
<p>There appears to be a positive correlation between the number of players and the total number of games played. This means that as the number of players in a country increases, the total number of games played also tends to increase.</p>
<p>There are a few points that stand out from the general trend. Especially, there is at least one country with a significantly higher number of players and total games played than the others. Which is Russia. Also large number of countries have a relatively low number of players and games played, which is indicated by the cluster of points towards the origin of the plot. ### COVID-19 Impact Analysis Since we only have data of standard games, we will analyze.</p>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># games_by_year = standard_df.groupby('Year')['Gms'].sum().reset_index()</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>games_2018 <span class="op">=</span> yearly_dfs[<span class="st">'2018'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>games_2019 <span class="op">=</span> yearly_dfs[<span class="st">'2019'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>games_2020 <span class="op">=</span> yearly_dfs[<span class="st">'2020'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>games_2021 <span class="op">=</span> yearly_dfs[<span class="st">'2021'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>games_2022 <span class="op">=</span> yearly_dfs[<span class="st">'2022'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> [<span class="st">'2018 '</span>,<span class="st">'2019'</span>, <span class="st">'2020'</span>, <span class="st">'2021'</span> ,<span class="st">'2022'</span>]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>games <span class="op">=</span> [games_2018 ,games_2019, games_2020,games_2021, games_2022]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>plt.bar(years, games)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comparison of Chess Games Played by Year Relative to COVID-19'</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Total Number of Games Played'</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-18-output-1.png" width="591" height="463"></p>
</div>
</div>
<p>As we can see from the plot, there is a huge decline of games played during Covid-19 pandemic. And also the recovery from Covid-19 in 2022.</p>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>games_2018_cze <span class="op">=</span> yearly_dfs[<span class="st">'2018'</span>][yearly_dfs[<span class="st">'2018'</span>][<span class="st">'Fed'</span>] <span class="op">==</span> <span class="st">'CZE'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>games_2019_cze <span class="op">=</span> yearly_dfs[<span class="st">'2019'</span>][yearly_dfs[<span class="st">'2019'</span>][<span class="st">'Fed'</span>] <span class="op">==</span> <span class="st">'CZE'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>games_2020_cze <span class="op">=</span> yearly_dfs[<span class="st">'2020'</span>][yearly_dfs[<span class="st">'2020'</span>][<span class="st">'Fed'</span>] <span class="op">==</span> <span class="st">'CZE'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>games_2021_cze <span class="op">=</span> yearly_dfs[<span class="st">'2021'</span>][yearly_dfs[<span class="st">'2021'</span>][<span class="st">'Fed'</span>] <span class="op">==</span> <span class="st">'CZE'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>games_2022_cze <span class="op">=</span> yearly_dfs[<span class="st">'2022'</span>][yearly_dfs[<span class="st">'2022'</span>][<span class="st">'Fed'</span>] <span class="op">==</span> <span class="st">'CZE'</span>][<span class="st">'Gms'</span>].<span class="bu">sum</span>()</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> [<span class="st">'2018 '</span>,<span class="st">'2019'</span>, <span class="st">'2020'</span>, <span class="st">'2021'</span> ,<span class="st">'2022'</span>]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>games <span class="op">=</span> [games_2018_cze ,games_2019_cze, games_2020_cze,games_2021_cze, games_2022_cze]</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>plt.bar(years, games)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comparison of Chess Games Played by Year Relative to COVID-19 in CZ'</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Total Number of Games Played'</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-19-output-1.png" width="636" height="449"></p>
</div>
</div>
<p>The similar situation is for Czech Republic. ## Yearly Rating Changes</p>
<p>Let’s calculate teh difference in player’s rating from begining to end of a year.</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming you have a DataFrame for standard games with 'Year', 'Rat', and 'ID Number'</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'ID Number' and 'Year', then get the first and last rating of the year</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>standard_yearly_changes <span class="op">=</span> standard_df.groupby([<span class="st">'ID Number'</span>, <span class="st">'Year'</span>])[<span class="st">'Rat'</span>].agg([<span class="st">'first'</span>, <span class="st">'last'</span>])</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'first' and 'last' to numeric, coercing errors to NaN</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>standard_yearly_changes[<span class="st">'first'</span>] <span class="op">=</span> pd.to_numeric(standard_yearly_changes[<span class="st">'first'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>standard_yearly_changes[<span class="st">'last'</span>] <span class="op">=</span> pd.to_numeric(standard_yearly_changes[<span class="st">'last'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the rating change</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>standard_yearly_changes[<span class="st">'Rating Change'</span>] <span class="op">=</span> standard_yearly_changes[<span class="st">'last'</span>] <span class="op">-</span> standard_yearly_changes[<span class="st">'first'</span>]</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the average rating change per year</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>avg_rating_change_per_year <span class="op">=</span> standard_yearly_changes.groupby(<span class="st">'Year'</span>)[<span class="st">'Rating Change'</span>].mean()</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>avg_rating_change_per_year.plot(kind<span class="op">=</span><span class="st">'line'</span>, title<span class="op">=</span><span class="st">'Average Yearly Rating Change for Standard Games'</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Rating Change'</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-20-output-1.png" width="589" height="449"></p>
</div>
</div>
<p>Again, we can see the drop of player rating during Covid-19. ### Title rating change</p>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'Year' and 'Tit', then get the first and last rating for each player</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>title_yearly_changes <span class="op">=</span> standard_df.groupby([<span class="st">'Tit'</span>, <span class="st">'Year'</span>])[<span class="st">'Rat'</span>].agg([<span class="st">'first'</span>, <span class="st">'last'</span>])</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>title_yearly_changes[<span class="st">'first'</span>] <span class="op">=</span> pd.to_numeric(title_yearly_changes[<span class="st">'first'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>title_yearly_changes[<span class="st">'last'</span>] <span class="op">=</span> pd.to_numeric(title_yearly_changes[<span class="st">'last'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the rating change for each player</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>title_yearly_changes[<span class="st">'Rating Change'</span>] <span class="op">=</span> title_yearly_changes[<span class="st">'last'</span>] <span class="op">-</span> title_yearly_changes[<span class="st">'first'</span>]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now calculate the average rating change for each title per year</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>avg_title_rating_change <span class="op">=</span> title_yearly_changes.groupby([<span class="st">'Year'</span>, <span class="st">'Tit'</span>])[<span class="st">'Rating Change'</span>].mean().unstack()</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>avg_title_rating_change.plot(kind<span class="op">=</span><span class="st">'line'</span>,figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>), marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Average Yearly Rating Change by Title for Standard Games'</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Rating Change'</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Title'</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Title'</span>, loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-21-output-1.png" width="827" height="597"></p>
</div>
</div>
<p>Grandmasters (GMs) demonstrated relative stability in their rating changes, suggesting a consistent performance at the elite level, though a dip in 2020 aligns with the disruptive onset of the COVID-19 pandemic.</p>
<p>The years 2021 and 2022 indicate a general trend of recovery or return to form, as ratings begin to climb again.</p>
<p>Distinct trends are observed in titles specific to female players (WCM, WFM, WGM, and WIM), each displaying unique patterns year over year. The WCM title, in particular, shows an atypical negative swing in 2021.</p>
<p>The anomaly observed in 2019 for CMs, marked by a substantial positive change, could be attributed to a range of factors, potentially including a smaller sample size or exceptional performances by a few individuals within this group.</p>
<p>Also the rate for WCM does not change at all.</p>
<section id="player-rating-change-carlsen-magnus" class="level3">
<h3 class="anchored" data-anchor-id="player-rating-change-carlsen-magnus">Player rating change (Carlsen Magnus)</h3>
<p>Let’s analyze the rating change of one of the best chess player Carlsen Magnus.</p>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the dataset for rows where the 'Name' column matches 'Carlsen, Magnus'</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>carlsen_data <span class="op">=</span> standard_df[standard_df[<span class="st">'Name'</span>] <span class="op">==</span> <span class="st">'Carlsen, Magnus'</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Rat' to numeric, setting errors='coerce' will convert non-numeric values to NaN</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>carlsen_data[<span class="st">'Rat'</span>] <span class="op">=</span> pd.to_numeric(carlsen_data[<span class="st">'Rat'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows where 'Rat' is NaN since we cannot calculate changes with missing values</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>carlsen_data <span class="op">=</span> carlsen_data.dropna(subset<span class="op">=</span>[<span class="st">'Rat'</span>])</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine 'Year' and 'Mon' columns to create a 'Period' column and convert to datetime</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>carlsen_data[<span class="st">'Period'</span>] <span class="op">=</span> carlsen_data[<span class="st">'Year'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'-'</span> <span class="op">+</span> carlsen_data[<span class="st">'Mon'</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.pad(<span class="dv">2</span>, fillchar<span class="op">=</span><span class="st">'0'</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>carlsen_data[<span class="st">'Period'</span>] <span class="op">=</span> pd.to_datetime(carlsen_data[<span class="st">'Period'</span>]).dt.to_period(<span class="st">'M'</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame by 'Period'</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>carlsen_data.sort_values(<span class="st">'Period'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the rating change. The first value will be NaN since there's no previous rating to subtract from</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>carlsen_data[<span class="st">'Rating Change'</span>] <span class="op">=</span> carlsen_data[<span class="st">'Rat'</span>].diff()</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'Year' and calculate the first and last ratings to get the yearly rating change</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>carlsen_yearly_changes <span class="op">=</span> carlsen_data.groupby(<span class="st">'Year'</span>)[<span class="st">'Rat'</span>].agg([<span class="st">'first'</span>, <span class="st">'last'</span>])</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>carlsen_yearly_changes[<span class="st">'Yearly Rating Change'</span>] <span class="op">=</span> carlsen_yearly_changes[<span class="st">'last'</span>] <span class="op">-</span> carlsen_yearly_changes[<span class="st">'first'</span>]</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting yearly rating changes</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>carlsen_yearly_changes[<span class="st">'Yearly Rating Change'</span>].plot(kind<span class="op">=</span><span class="st">'bar'</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Yearly Rating Change for Magnus Carlsen'</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Rating Change'</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting monthly rating over time</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>plt.plot(carlsen_data[<span class="st">'Period'</span>].astype(<span class="bu">str</span>), carlsen_data[<span class="st">'Rat'</span>], marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Rating Over Time for Magnus Carlsen'</span>)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Period'</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Rating'</span>)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Tomas Nguyen\AppData\Local\Temp\ipykernel_17424\613479383.py:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  carlsen_data['Rat'] = pd.to_numeric(carlsen_data['Rat'], errors='coerce')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-22-output-2.png" width="819" height="544"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-22-output-3.png" width="974" height="566"></p>
</div>
</div>
<p>The monthly plot presents a detailed view of Magnus Carlsen’s chess rating over a period from 2017 to 2022, marked on a monthly basis. Notable are the significant fluctuations in his rating, which peaks and troughs, reflecting the dynamic nature of competitive chess where even the highest-rated players can experience considerable variability in their performance. The graph shows that Carlsen’s rating oscillates but remains within an elite threshold, underscoring his consistent high-level play. The stability between the sharp changes is as remarkable as the volatility, suggesting periods of sustained performance.</p>
<p>The yearly plot simplifies the view into yearly rating changes, providing a clear depiction of Carlsen’s performance on an annual scale. The most significant change occurs in 2019, indicating either a stellar year of successes or an adjustment in the rating calculation. The following years show smaller increases or decreases, hinting at a return to a steadier state of play. However, the variations between years suggest that external factors, such as the global pandemic or changes in competitive activity, may have impacted his annual performance.</p>
</section>
</section>
<section id="summary-of-data" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-data">Summary of data</h2>
<p>The analysis provides a overview of the global chess landscape from December 2017 to December 2022 for standadr games and 2022 rapid and blitz games. It focuses on player rankings, ratings, and the impact of the COVID-19 pandemic.</p>
<p>One of the main findings is the distribution of chess ratings among players with different titles, such as Grandmasters (GM), International Masters (IM), and Fide Masters (FM). Higher titles generally correspond to higher ratings, but there are overlaps in ratings between certain titles. Grandmasters, in particular, have a noticeably higher median rating, reflecting their advanced skill level.</p>
<p>The analysis also explores the distribution of player ratings by country and continent. Europe and Asia have strong chess player populations, especially in the mid to high rating intervals, indicating a competitive environment. North America leads in terms of average player rating, suggesting a higher overall skill level or stronger competition.</p>
<p>The preference for standard chess games over blitz and rapid is observed globally, although some countries show comparable participation in different game modes. There is a positive correlation between the number of players and the total number of games played in a country. Russia stands out with a significantly higher player count and games played than other countries.</p>
<p>The impact of the COVID-19 pandemic on chess is evident in the analysis, with a substantial decline in games played and player ratings during the pandemic. However, there is a recovery trend in 2022. Grandmasters displayed relative stability in their rating changes, while other player categories experienced fluctuations.</p>
<p>Lastly, the analysis includes a case study of Magnus Carlsen’s rating changes from 2017 to 2022. It reveals significant fluctuations in his rating, with notable changes in 2019 and subsequent years.</p>
</section>
</section>
<section id="data-preparation" class="level1">
<h1>Data preparation</h1>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data cleaning</h2>
<p>Let’s exclude all irrelevant fields, and also handle mssing values, and merge them into one big <code>DataFrame</code>.</p>
<section id="data-preparation-1" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation-1">Data preparation</h3>
<p>Let’s merge all data into one bug <code>DataFrame</code></p>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a 'Game Mode' column to each DataFrame before concatenation</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>blitz2022df[<span class="st">'Game Mode'</span>] <span class="op">=</span> <span class="st">'Blitz'</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>rapid2022df[<span class="st">'Game Mode'</span>] <span class="op">=</span> <span class="st">'Rapid'</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>standard_df[<span class="st">'Game Mode'</span>] <span class="op">=</span> <span class="st">'Standard'</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>all_chess_data <span class="op">=</span> pd.concat([blitz2022df, rapid2022df, standard_df], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Rat' and 'Gms' to numeric and handle missing values</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Rat'</span>] <span class="op">=</span> pd.to_numeric(all_chess_data[<span class="st">'Rat'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Gms'</span>] <span class="op">=</span> pd.to_numeric(all_chess_data[<span class="st">'Gms'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>all_chess_data.dropna(subset<span class="op">=</span>[<span class="st">'Rat'</span>, <span class="st">'Gms'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize string fields</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Fed'</span>] <span class="op">=</span> all_chess_data[<span class="st">'Fed'</span>].<span class="bu">str</span>.upper().<span class="bu">str</span>.strip()</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Sex'</span>] <span class="op">=</span> all_chess_data[<span class="st">'Sex'</span>].<span class="bu">str</span>.upper().<span class="bu">str</span>.strip()</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Tit'</span>] <span class="op">=</span> all_chess_data[<span class="st">'Tit'</span>].<span class="bu">str</span>.upper().<span class="bu">str</span>.strip()</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'WTit'</span>] <span class="op">=</span> all_chess_data[<span class="st">'Tit'</span>].<span class="bu">str</span>.upper().<span class="bu">str</span>.strip()</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'OTit'</span>] <span class="op">=</span> all_chess_data[<span class="st">'Tit'</span>].<span class="bu">str</span>.upper().<span class="bu">str</span>.strip()</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>all_chess_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID Number</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Fed</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Tit</th>
<th data-quarto-table-cell-role="th">WTit</th>
<th data-quarto-table-cell-role="th">OTit</th>
<th data-quarto-table-cell-role="th">FOA</th>
<th data-quarto-table-cell-role="th">Rat</th>
<th data-quarto-table-cell-role="th">Gms</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">B-day</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Mon</th>
<th data-quarto-table-cell-role="th">Game Mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10207538</td>
<td>A E M, Doshtagir</td>
<td>BAN</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1860.0</td>
<td>0</td>
<td>20</td>
<td>1974</td>
<td>i</td>
<td>2022</td>
<td>1</td>
<td>Blitz</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10680810</td>
<td>A hamed Ashraf, Abdallah</td>
<td>EGY</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1741.0</td>
<td>0</td>
<td>20</td>
<td>2001</td>
<td>NaN</td>
<td>2022</td>
<td>1</td>
<td>Blitz</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5716373</td>
<td>A Rajah, Abdul Shukor</td>
<td>MAS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1873.0</td>
<td>0</td>
<td>20</td>
<td>0</td>
<td>i</td>
<td>2022</td>
<td>1</td>
<td>Blitz</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4804929</td>
<td>A-ALI, Sali Abbas Abdulzahra</td>
<td>IRQ</td>
<td>F</td>
<td>WFM</td>
<td>WFM</td>
<td>WFM</td>
<td>NaN</td>
<td>1695.0</td>
<td>9</td>
<td>20</td>
<td>2001</td>
<td>w</td>
<td>2022</td>
<td>1</td>
<td>Blitz</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5700230</td>
<td>A.B, Muhd Yusop</td>
<td>MAS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1528.0</td>
<td>0</td>
<td>20</td>
<td>1983</td>
<td>i</td>
<td>2022</td>
<td>1</td>
<td>Blitz</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26209183</td>
<td>34190632</td>
<td>Zyubin, Sergey</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1884.0</td>
<td>0</td>
<td>40</td>
<td>1975</td>
<td>i</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26209184</td>
<td>55746969</td>
<td>Zyuganov, Igor</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1325.0</td>
<td>10</td>
<td>40</td>
<td>2010</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26209185</td>
<td>24232602</td>
<td>Zyuzev, Pavel</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1856.0</td>
<td>0</td>
<td>40</td>
<td>1993</td>
<td>i</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26209186</td>
<td>1189980</td>
<td>Zywert, Kacper</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1519.0</td>
<td>0</td>
<td>20</td>
<td>1999</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26209187</td>
<td>21857814</td>
<td>Zyznowska, Marianna</td>
<td>POL</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1150.0</td>
<td>0</td>
<td>40</td>
<td>2004</td>
<td>wi</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
</tr>
</tbody>
</table>

<p>26209182 rows × 16 columns</p>
</div>
</div>
</div>
</section>
<section id="country-code-correction" class="level3">
<h3 class="anchored" data-anchor-id="country-code-correction">Country code correction</h3>
<p>In data expoloration we noticed, that we also have data irregularities such as <code>MAS</code> and <code>MYS</code> in <code>Fed</code> column, where the two values means the same federation, Malaysia.</p>
<p>Let’s print unique country codes in dataset.</p>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>unique_country_codes <span class="op">=</span> all_chess_data[<span class="st">'Fed'</span>].unique()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>unique_country_codes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array(['BAN', 'EGY', 'MAS', 'IRQ', 'BRN', 'IRI', 'IND', 'SRI', 'NOR',
       'SUD', 'DEN', 'SCO', 'FIN', 'RUS', 'MDV', 'UAE', 'PAK', 'AUS',
       'MAR', 'JOR', 'TUR', 'CUB', 'ESP', 'ECU', 'PER', 'URU', 'PAN',
       'KGZ', 'LBA', 'PHI', 'GEO', 'ITA', 'BOL', 'GER', 'CRC', 'CHI',
       'MEX', 'ESA', 'AZE', 'TUN', 'VEN', 'BRA', 'ARG', 'KAZ', 'CYP',
       'GRE', 'KOS', 'UKR', 'ENG', 'LBN', 'FRA', 'BEL', 'ALG', 'PLE',
       'POL', 'MTN', 'UZB', 'YEM', 'CAN', 'POR', 'AFG', 'BIH', 'MKD',
       'DJI', 'ISR', 'PAR', 'SUR', 'AUT', 'IRL', 'SOM', 'KUW', 'USA',
       'UGA', 'NGR', 'QAT', 'TKM', 'SWE', 'ROU', 'ETH', 'JPN', 'HUN',
       'SVK', 'CZE', 'KEN', 'ARM', 'CRO', 'ANG', 'FID', 'LAT', 'SYR',
       'EST', 'LBR', 'MDA', 'BLR', 'SRB', 'MNE', 'MOZ', 'COL', 'DOM',
       'TJK', 'NCA', 'PUR', 'ISL', 'NEP', 'SUI', 'LTU', 'NED', 'SLO',
       'HKG', 'GHA', 'HON', 'PLW', 'LUX', 'WLS', 'SLE', 'BOT', 'FIJ',
       'THA', 'SGP', 'ALB', 'TOG', 'MGL', 'MLT', 'TTO', 'RSA', 'OMA',
       'KSA', 'KOR', 'BRU', 'INA', 'FAI', 'BUL', 'AND', 'NZL', 'MLI',
       'MAD', 'GUM', 'CIV', 'CMR', 'ZIM', 'VIE', 'ARU', 'GUA', 'MNC',
       'TPE', 'ERI', 'JCI', 'MYA', 'SEN', 'GAM', 'CHN', 'SOL', 'JAM',
       'LES', 'ZAM', 'BAR', 'CPV', 'GCI', 'BER', 'MRI', 'AHO', 'SMR',
       'NAM', 'GAB', 'HAI', 'GUY', 'SWZ', 'MAW', 'BDI', 'STP', 'CAF',
       'TLS', 'SSD', 'PNG', 'LIE', 'ANT', 'COD', 'BUR', 'SEY', 'MAC',
       'LAO', 'BAH', 'LCA', 'RWA', 'CAY', 'CHA', 'NRU', 'VIN', 'CAM',
       'BHU', 'TAN', 'IOM', 'ISV', 'CGO', 'IVB', 'DMA', 'GEQ', 'COM',
       'SKN'], dtype=object)</code></pre>
</div>
</div>
<p>From this list we can see these codes, are not considered as correct country iso codes, based on this <a href="https://www.nationsonline.org/oneworld/country_code_list.htm">website</a>.</p>
<ol type="1">
<li><code>MAS</code> - Commonly used for Malaysia, but the ISO code is <code>MYS</code>.</li>
<li><code>BAN</code> - Usually represents Bangladesh, but the standard ISO code is <code>BGD</code>.</li>
<li><code>IRI</code> - Often used for Iran, whereas the ISO code is <code>IRN</code>.</li>
<li><code>SRI</code> - Typically Sri Lanka, with the ISO code being <code>LKA</code>.</li>
<li><code>SCO</code> - Scotland doesn’t have an ISO code as it is part of the United Kingdom (<code>GBR</code>).</li>
<li><code>LBA</code> - Common for Libya, but the ISO code is <code>LBY</code>.</li>
<li><code>ESA</code> - Often used for El Salvador, which has the ISO code <code>SLV</code>.</li>
<li><code>ENG</code> - England is part of the United Kingdom (<code>GBR</code>).</li>
<li><code>PLE</code> - Used for Palestine, which is typically represented by <code>PSE</code>.</li>
<li><code>MTN</code> - Likely Mauritania, which has the ISO code <code>MRT</code>.</li>
<li><code>WLS</code> - Wales is part of the United Kingdom (<code>GBR</code>).</li>
<li><code>FID</code> - Probably a misspelling of Fiji, which is <code>FJI</code>.</li>
<li><code>INA</code> - Commonly used for Indonesia, but the ISO code is <code>IDN</code>.</li>
<li><code>FAI</code> - Unclear, possibly a miscode.</li>
<li><code>BRU</code> - Likely Brunei, the ISO code is <code>BRN</code>.</li>
<li><code>PUR</code> - Puerto Rico, the ISO code is <code>PRI</code>.</li>
<li><code>NCA</code> - Commonly Nicaragua, ISO code is <code>NIC</code>.</li>
<li><code>RSA</code> - Commonly South Africa, ISO code is <code>ZAF</code>.</li>
<li><code>AHO</code> - Former code for Netherlands Antilles, now dissolved.</li>
<li><code>CHA</code> - Possibly Chad (<code>TCD</code>) or a miscode.</li>
<li><code>BER</code> - Likely Bermuda, ISO code is <code>BMU</code>.</li>
<li><code>TAN</code> - Tanzania has the ISO code <code>TZA</code>.</li>
<li><code>IOM</code> - Isle of Man, but typically uses <code>IMN</code>.</li>
<li><code>CGO</code> - Possibly Congo, which has two codes: <code>COG</code> for the Republic of the Congo and <code>COD</code> for the Democratic Republic of the Congo.</li>
<li><code>IVB</code> - British Virgin Islands, ISO code is <code>VGB</code>.</li>
</ol>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>country_code_corrections <span class="op">=</span> {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BAN'</span>: <span class="st">'BGD'</span>,  <span class="co"># Bangladesh</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MAS'</span>: <span class="st">'MYS'</span>,  <span class="co"># Malaysia</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IRI'</span>: <span class="st">'IRN'</span>,  <span class="co"># Iran</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SRI'</span>: <span class="st">'LKA'</span>,  <span class="co"># Sri Lanka</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'SCO'</span>: <span class="st">'GBR'</span>,  <span class="co"># Scotland (part of the United Kingdom)</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LBA'</span>: <span class="st">'LBY'</span>,  <span class="co"># Libya</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ESA'</span>: <span class="st">'SLV'</span>,  <span class="co"># El Salvador</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ENG'</span>: <span class="st">'GBR'</span>,  <span class="co"># England (part of the United Kingdom)</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PLE'</span>: <span class="st">'PSE'</span>,  <span class="co"># Palestine</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MTN'</span>: <span class="st">'MRT'</span>,  <span class="co"># Mauritania</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'WLS'</span>: <span class="st">'GBR'</span>,  <span class="co"># Wales (part of the United Kingdom)</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FID'</span>: <span class="st">'FJI'</span>,  <span class="co"># Fiji</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'INA'</span>: <span class="st">'IDN'</span>,  <span class="co"># Indonesia</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FAI'</span>: <span class="st">'Unknown'</span>,  <span class="co"># No clear equivalent; set as 'Unknown'</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BRU'</span>: <span class="st">'BRN'</span>,  <span class="co"># Brunei</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'PUR'</span>: <span class="st">'PRI'</span>,  <span class="co"># Puerto Rico</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NCA'</span>: <span class="st">'NIC'</span>,  <span class="co"># Nicaragua</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'RSA'</span>: <span class="st">'ZAF'</span>,  <span class="co"># South Africa</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AHO'</span>: <span class="st">'Unknown'</span>,  <span class="co"># Netherlands Antilles, now dissolved; set as 'Unknown'</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CHA'</span>: <span class="st">'Unknown'</span>,  <span class="co"># No clear equivalent; set as 'Unknown'</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BER'</span>: <span class="st">'BMU'</span>,  <span class="co"># Bermuda</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TAN'</span>: <span class="st">'TZA'</span>,  <span class="co"># Tanzania</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IOM'</span>: <span class="st">'IMN'</span>,  <span class="co"># Isle of Man</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CGO'</span>: <span class="st">'COG'</span>,  <span class="co"># Republic of the Congo (assuming it's not Democratic Republic of the Congo)</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'IVB'</span>: <span class="st">'VGB'</span>,  <span class="co"># British Virgin Islands</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the corrections to the 'Fed' column</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Fed'</span>] <span class="op">=</span> all_chess_data[<span class="st">'Fed'</span>].replace(country_code_corrections)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-check the unique country codes after correction</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Fed'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>array(['BGD', 'EGY', 'MYS', 'IRQ', 'BRN', 'IRN', 'IND', 'LKA', 'NOR',
       'SUD', 'DEN', 'GBR', 'FIN', 'RUS', 'MDV', 'UAE', 'PAK', 'AUS',
       'MAR', 'JOR', 'TUR', 'CUB', 'ESP', 'ECU', 'PER', 'URU', 'PAN',
       'KGZ', 'LBY', 'PHI', 'GEO', 'ITA', 'BOL', 'GER', 'CRC', 'CHI',
       'MEX', 'SLV', 'AZE', 'TUN', 'VEN', 'BRA', 'ARG', 'KAZ', 'CYP',
       'GRE', 'KOS', 'UKR', 'LBN', 'FRA', 'BEL', 'ALG', 'PSE', 'POL',
       'MRT', 'UZB', 'YEM', 'CAN', 'POR', 'AFG', 'BIH', 'MKD', 'DJI',
       'ISR', 'PAR', 'SUR', 'AUT', 'IRL', 'SOM', 'KUW', 'USA', 'UGA',
       'NGR', 'QAT', 'TKM', 'SWE', 'ROU', 'ETH', 'JPN', 'HUN', 'SVK',
       'CZE', 'KEN', 'ARM', 'CRO', 'ANG', 'FJI', 'LAT', 'SYR', 'EST',
       'LBR', 'MDA', 'BLR', 'SRB', 'MNE', 'MOZ', 'COL', 'DOM', 'TJK',
       'NIC', 'PRI', 'ISL', 'NEP', 'SUI', 'LTU', 'NED', 'SLO', 'HKG',
       'GHA', 'HON', 'PLW', 'LUX', 'SLE', 'BOT', 'FIJ', 'THA', 'SGP',
       'ALB', 'TOG', 'MGL', 'MLT', 'TTO', 'ZAF', 'OMA', 'KSA', 'KOR',
       'IDN', 'Unknown', 'BUL', 'AND', 'NZL', 'MLI', 'MAD', 'GUM', 'CIV',
       'CMR', 'ZIM', 'VIE', 'ARU', 'GUA', 'MNC', 'TPE', 'ERI', 'JCI',
       'MYA', 'SEN', 'GAM', 'CHN', 'SOL', 'JAM', 'LES', 'ZAM', 'BAR',
       'CPV', 'GCI', 'BMU', 'MRI', 'SMR', 'NAM', 'GAB', 'HAI', 'GUY',
       'SWZ', 'MAW', 'BDI', 'STP', 'CAF', 'TLS', 'SSD', 'PNG', 'LIE',
       'ANT', 'COD', 'BUR', 'SEY', 'MAC', 'LAO', 'BAH', 'LCA', 'RWA',
       'CAY', 'NRU', 'VIN', 'CAM', 'BHU', 'TZA', 'IMN', 'ISV', 'COG',
       'VGB', 'DMA', 'GEQ', 'COM', 'SKN'], dtype=object)</code></pre>
</div>
</div>
</section>
<section id="player-age" class="level3">
<h3 class="anchored" data-anchor-id="player-age">Player Age</h3>
<p>Calculate the age of players from the <code>B-day</code> (birth year) field. Age can be a significant factor in performance.</p>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Year' and 'B-day' columns to numeric</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Year'</span>] <span class="op">=</span> pd.to_numeric(all_chess_data[<span class="st">'Year'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'B-day'</span>] <span class="op">=</span> pd.to_numeric(all_chess_data[<span class="st">'B-day'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop any rows where conversion to numeric resulted in NaN values</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>all_chess_data.dropna(subset<span class="op">=</span>[<span class="st">'Year'</span>, <span class="st">'B-day'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Age'</span>] <span class="op">=</span> all_chess_data[<span class="st">'Year'</span>] <span class="op">-</span> all_chess_data[<span class="st">'B-day'</span>]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out rows where age is not within a reasonable range (5 to 100 years)</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>all_chess_data <span class="op">=</span> all_chess_data[all_chess_data[<span class="st">'Age'</span>].between(<span class="dv">5</span>, <span class="dv">100</span>)]</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>all_chess_data[<span class="st">'Age'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0           48.0
1           21.0
3           21.0
4           39.0
7           26.0
            ... 
26209183    47.0
26209184    12.0
26209185    29.0
26209186    23.0
26209187    18.0
Name: Age, Length: 25613694, dtype: float64</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="modeling" class="level1">
<h1>Modeling</h1>
<section id="player-performance-prediction-standard-games-magnus-carlson" class="level2">
<h2 class="anchored" data-anchor-id="player-performance-prediction-standard-games-magnus-carlson">Player Performance Prediction Standard Games (Magnus Carlson)</h2>
<p>Let’s analyze Carlsen Magnus prediction in Standard games.</p>
<div class="cell" data-execution_count="26">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>carlsen_data <span class="op">=</span> all_chess_data[all_chess_data[<span class="st">'Name'</span>] <span class="op">==</span> <span class="st">'Carlsen, Magnus'</span>]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>carlsen_data <span class="op">=</span> carlsen_data[carlsen_data[<span class="st">'Game Mode'</span>] <span class="op">==</span> <span class="st">'Standard'</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill missing values or drop them</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>carlsen_data[<span class="st">'Year'</span>] <span class="op">=</span> carlsen_data[<span class="st">'Year'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>carlsen_data[<span class="st">'Mon'</span>] <span class="op">=</span> carlsen_data[<span class="st">'Mon'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the DataFrame by 'Year' and 'Mon' in ascending order</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>carlsen_data.sort_values(by<span class="op">=</span>[<span class="st">'Year'</span>, <span class="st">'Mon'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 'Date' column that represents the month and year</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>carlsen_data[<span class="st">'Date'</span>] <span class="op">=</span> (carlsen_data[<span class="st">'Year'</span>].astype(<span class="bu">str</span>) <span class="op">+</span> <span class="st">'-'</span> <span class="op">+</span> carlsen_data[<span class="st">'Mon'</span>].astype(<span class="bu">str</span>))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Use this composite index as the new index for the DataFrame</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>carlsen_data.set_index(<span class="st">'Date'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>carlsen_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID Number</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Fed</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Tit</th>
<th data-quarto-table-cell-role="th">WTit</th>
<th data-quarto-table-cell-role="th">OTit</th>
<th data-quarto-table-cell-role="th">FOA</th>
<th data-quarto-table-cell-role="th">Rat</th>
<th data-quarto-table-cell-role="th">Gms</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">B-day</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Mon</th>
<th data-quarto-table-cell-role="th">Game Mode</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017-12</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2837.0</td>
<td>0</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2017</td>
<td>12</td>
<td>Standard</td>
<td>27.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018-1</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2834.0</td>
<td>9</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2018</td>
<td>1</td>
<td>Standard</td>
<td>28.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018-2</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2843.0</td>
<td>13</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2018</td>
<td>2</td>
<td>Standard</td>
<td>28.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018-3</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2843.0</td>
<td>0</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2018</td>
<td>3</td>
<td>Standard</td>
<td>28.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018-4</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2843.0</td>
<td>0</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2018</td>
<td>4</td>
<td>Standard</td>
<td>28.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-8</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2864.0</td>
<td>0</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2022</td>
<td>8</td>
<td>Standard</td>
<td>32.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-9</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2861.0</td>
<td>9</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2022</td>
<td>9</td>
<td>Standard</td>
<td>32.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-10</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2856.0</td>
<td>3</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2022</td>
<td>10</td>
<td>Standard</td>
<td>32.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022-11</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2859.0</td>
<td>6</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2022</td>
<td>11</td>
<td>Standard</td>
<td>32.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022-12</td>
<td>1503014</td>
<td>Carlsen, Magnus</td>
<td>NOR</td>
<td>M</td>
<td>GM</td>
<td>GM</td>
<td>GM</td>
<td>NaN</td>
<td>2859.0</td>
<td>0</td>
<td>10</td>
<td>1990.0</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
<td>32.0</td>
</tr>
</tbody>
</table>

<p>61 rows × 17 columns</p>
</div>
</div>
</div>
<section id="model" class="level3">
<h3 class="anchored" data-anchor-id="model">Model</h3>
<p>In this Python block, a approach to regression analysis is demonstrated, showcasing the selection and evaluation of various regression models for predictive accuracy. The script processes the <code>carlsen_data</code> data, focusing on predicting a specific target variable through a range of regression algorithms including Ridge, Lasso, and ElasticNet. Each of these models is tested across different hyperparameters, notably varying <em>alpha</em> values for regularization strength and <em>polynomial degrees</em> for feature engineering.</p>
<p>As features we use year, month, age and games played. To avoid potential overfitting we will not use Decision trees nor Random Forests.</p>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, KFold, cross_val_score</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge, Lasso, ElasticNet</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures, StandardScaler</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">'Year'</span>, <span class="st">'Mon'</span>, <span class="st">'Age'</span>, <span class="st">'Gms'</span>]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> carlsen_data[features]</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> carlsen_data[<span class="st">'Rat'</span>]</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and test sets</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize best model parameters</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>best_model_name <span class="op">=</span> <span class="va">None</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>best_model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> {}</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>best_mse <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a range of alpha values for Ridge, Lasso, and ElasticNet</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">8</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a range of polynomial degrees</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>degrees <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a range of max_depth values for Decision Tree and Random Forest</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>max_depths <span class="op">=</span> [<span class="va">None</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>]</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Define k-fold cross-validation</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>kf <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Define regression models to test</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>regression_models <span class="op">=</span> {</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Ridge'</span>: Ridge,</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Lasso'</span>: Lasso,</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ElasticNet'</span>: ElasticNet,</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 'DecisionTree': DecisionTreeRegressor,</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 'RandomForest': RandomForestRegressor</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, Model <span class="kw">in</span> regression_models.items():</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> name <span class="kw">in</span> [<span class="st">'Ridge'</span>, <span class="st">'Lasso'</span>, <span class="st">'ElasticNet'</span>]:</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> alpha <span class="kw">in</span> alphas:</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> degree <span class="kw">in</span> degrees:</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>                model <span class="op">=</span> Pipeline([</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>                    (<span class="st">'poly'</span>, PolynomialFeatures(degree<span class="op">=</span>degree)),</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>                    (<span class="st">'scaler'</span>, StandardScaler()),</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>                    (<span class="st">'regression'</span>, Model(alpha<span class="op">=</span>alpha))</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>                ])</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>                mse_scores <span class="op">=</span> <span class="op">-</span>cross_val_score(model, X_train, y_train, cv<span class="op">=</span>kf, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>)</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>                avg_mse <span class="op">=</span> np.mean(mse_scores)</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> avg_mse <span class="op">&lt;</span> best_mse:</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>                    best_mse <span class="op">=</span> avg_mse</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>                    best_model_name <span class="op">=</span> name</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>                    best_model <span class="op">=</span> model</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>                    best_params <span class="op">=</span> {<span class="st">'alpha'</span>: alpha, <span class="st">'degree'</span>: degree}</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> max_depth <span class="kw">in</span> max_depths:</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> Model(max_depth<span class="op">=</span>max_depth)</span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>            mse_scores <span class="op">=</span> <span class="op">-</span>cross_val_score(model, X_train, y_train, cv<span class="op">=</span>kf, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>)</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>            avg_mse <span class="op">=</span> np.mean(mse_scores)</span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> avg_mse <span class="op">&lt;</span> best_mse:</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>                best_mse <span class="op">=</span> avg_mse</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>                best_model_name <span class="op">=</span> name</span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>                best_model <span class="op">=</span> model</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>                best_params <span class="op">=</span> {<span class="st">'max_depth'</span>: max_depth}</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Best Model: </span><span class="sc">{</span>best_model_name<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Best Parameters: </span><span class="sc">{</span>best_params<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Best MSE: </span><span class="sc">{</span>best_mse<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> best_model_name <span class="kw">in</span> [<span class="st">'Ridge'</span>, <span class="st">'Lasso'</span>, <span class="st">'ElasticNet'</span>]:</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>    final_model <span class="op">=</span> Pipeline([</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'poly'</span>, PolynomialFeatures(degree<span class="op">=</span>best_params[<span class="st">'degree'</span>])),</span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'scaler'</span>, StandardScaler()),</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'regression'</span>, regression_models[best_model_name](alpha<span class="op">=</span>best_params[<span class="st">'alpha'</span>]))</span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>    final_model <span class="op">=</span> regression_models[best_model_name](<span class="op">**</span>best_params)</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>final_model.fit(X_train, y_train)</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on the test data</span></span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>y_pred_test <span class="op">=</span> final_model.predict(X_test)</span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the final model</span></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>mse_test <span class="op">=</span> mean_squared_error(y_test, y_pred_test)</span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>r2_test <span class="op">=</span> r2_score(y_test, y_pred_test)</span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Final Model Mean Squared Error on Test Data: </span><span class="sc">{</span>mse_test<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Final Model R-squared (R2) Score on Test Data: </span><span class="sc">{</span>r2_test<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best Model: Lasso
Best Parameters: {'alpha': 1e-05, 'degree': 3}
Best MSE: 115.3221513862206
Final Model Mean Squared Error on Test Data: 135.56737316464566
Final Model R-squared (R2) Score on Test Data: -0.041782742125550776</code></pre>
</div>
</div>
</section>
<section id="evaluation-and-visualization-of-test-and-trained-data" class="level3">
<h3 class="anchored" data-anchor-id="evaluation-and-visualization-of-test-and-trained-data">Evaluation and visualization of Test and Trained Data</h3>
<div class="cell" data-execution_count="28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>predictions_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Actual'</span>: y_test,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Predicted'</span>: y_pred_test</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>predictions_df.sort_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>plt.plot(predictions_df.index, predictions_df[<span class="st">'Actual'</span>], label<span class="op">=</span><span class="st">'Actual Ratings'</span>, marker<span class="op">=</span><span class="st">'o'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>plt.plot(predictions_df.index, predictions_df[<span class="st">'Predicted'</span>], label<span class="op">=</span><span class="st">'Predicted Ratings'</span>, marker<span class="op">=</span><span class="st">'x'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Actual vs Predicted Chess Ratings Over Time'</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Chess Rating'</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)  </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-29-output-1.png" width="602" height="485"></p>
</div>
</div>
<p>From the visual representation, it can be observed that the predicted ratings generally follow the trend of the actual ratings quite closely. The model seems to capture the overall upward and downward movements in the ratings over time. However, there are instances where the predictions do not perfectly align with the actual ratings, which is expected since model predictions rarely match exactly with real-world data.</p>
</section>
<section id="preditcion" class="level3">
<h3 class="anchored" data-anchor-id="preditcion">Preditcion</h3>
<p>Let’s predict for 2024. For prediction, the Games played previous month <code>Gms</code> would one game per month.</p>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the player's age for each month in 2024</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_age(birth_date, target_date):</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> target_date <span class="op">-</span> birth_date</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>dates_2024 <span class="op">=</span> pd.date_range(start<span class="op">=</span><span class="st">'2024-01-01'</span>, end<span class="op">=</span><span class="st">'2024-12-31'</span>, freq<span class="op">=</span><span class="st">'M'</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>data_2024 <span class="op">=</span> pd.DataFrame({<span class="st">'Year'</span>: dates_2024.year, <span class="st">'Mon'</span>: dates_2024.month})</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>data_2024[<span class="st">'Age'</span>] <span class="op">=</span> <span class="fl">2024.0</span><span class="op">-</span><span class="fl">1990.0</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>data_2024[<span class="st">'Gms'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the trained model to make predictions</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>predicted_ratings_2024 <span class="op">=</span> final_model.predict(data_2024)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame to store the predictions along with the dates</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>predictions_df <span class="op">=</span> pd.DataFrame({<span class="st">'Date'</span>: dates_2024, <span class="st">'Predicted_Ratings'</span>: predicted_ratings_2024})</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the predicted ratings</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>plt.plot(predictions_df[<span class="st">'Date'</span>], predictions_df[<span class="st">'Predicted_Ratings'</span>], label<span class="op">=</span><span class="st">'Predicted Ratings'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Predicted Ratings'</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Predicted Ratings for 2024'</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-30-output-1.png" width="604" height="485"></p>
</div>
</div>
<p>There is a clear downward trend in the predicted ratings over the period. The reason may be due several factors:</p>
<ol type="1">
<li><strong>Historical Data</strong>: The model has been trained on historical data, which includes the actual ratings up until the end of the data set. The model learns the underlying patterns in this historical data to make future predictions.</li>
<li><strong>Trend Analysis</strong>: If the actual ratings in the past have shown a tendency to decrease around the same period (April to June), the model might capture this seasonal trend and project it into the future.</li>
</ol>
<p>In conclusion player’s performance will be worse.</p>
</section>
</section>
<section id="player-segmentation-clustering" class="level2">
<h2 class="anchored" data-anchor-id="player-segmentation-clustering">Player Segmentation (Clustering)</h2>
<p>Because the dataset is big we will work on randomly sampled data. We’re working with a subset of the <code>all_chess_data</code> DataFrame that includes only <code>Standard</code> game mode data. To manage computational load, a 1% sample of this subset is taken. The data is then preprocessed: numerical features are scaled for uniformity, and categorical features are one-hot encoded to transform them into a numerical format that the algorithm can interpret.</p>
<div class="cell" data-execution_count="30">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, OneHotEncoder</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>all_chess_data_standard <span class="op">=</span> all_chess_data[all_chess_data[<span class="st">'Game Mode'</span>] <span class="op">==</span> <span class="st">'Standard'</span>]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample a subset of the data, for example, 1% of the dataset</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>sampled_data <span class="op">=</span> all_chess_data_standard.sample(frac<span class="op">=</span><span class="fl">0.01</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the preprocessing for numeric and categorical features</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>numeric_features <span class="op">=</span> [<span class="st">'Rat'</span>, <span class="st">'Gms'</span>, <span class="st">'Age'</span>]</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>numeric_transformer <span class="op">=</span> StandardScaler()</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>categorical_features <span class="op">=</span> [<span class="st">'Tit'</span>, <span class="st">'Fed'</span>]</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>categorical_transformer <span class="op">=</span> OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">'ignore'</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'num'</span>, numeric_transformer, numeric_features),</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'cat'</span>, categorical_transformer, categorical_features)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Pipeline with preprocessing and clustering</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>cluster_pipeline <span class="op">=</span> Pipeline(steps<span class="op">=</span>[(<span class="st">'preprocessor'</span>, preprocessor),</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>                                   (<span class="st">'cluster'</span>, KMeans(n_clusters<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">42</span>))])</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>cluster_pipeline.fit(sampled_data)</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Get cluster labels</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>clusters <span class="op">=</span> cluster_pipeline.named_steps[<span class="st">'cluster'</span>].labels_</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>sampled_data[<span class="st">'Cluster'</span>] <span class="op">=</span> clusters</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>sampled_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID Number</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Fed</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Tit</th>
<th data-quarto-table-cell-role="th">WTit</th>
<th data-quarto-table-cell-role="th">OTit</th>
<th data-quarto-table-cell-role="th">FOA</th>
<th data-quarto-table-cell-role="th">Rat</th>
<th data-quarto-table-cell-role="th">Gms</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">B-day</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Mon</th>
<th data-quarto-table-cell-role="th">Game Mode</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Cluster</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">12258019</td>
<td>25014366</td>
<td>Kumar Vinay</td>
<td>IND</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1708.0</td>
<td>0</td>
<td>40</td>
<td>1974.0</td>
<td>i</td>
<td>2019</td>
<td>11</td>
<td>Standard</td>
<td>45.0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17311274</td>
<td>45090394</td>
<td>Mala Sathish</td>
<td>IND</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1307.0</td>
<td>0</td>
<td>40</td>
<td>1998.0</td>
<td>i</td>
<td>2021</td>
<td>1</td>
<td>Standard</td>
<td>23.0</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17279655</td>
<td>184942</td>
<td>Knuttzen, Joaquin</td>
<td>ARG</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1556.0</td>
<td>0</td>
<td>40</td>
<td>2004.0</td>
<td>NaN</td>
<td>2021</td>
<td>1</td>
<td>Standard</td>
<td>17.0</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14392757</td>
<td>303267</td>
<td>Kozak, Milos</td>
<td>CZE</td>
<td>M</td>
<td>FM</td>
<td>FM</td>
<td>FM</td>
<td>NaN</td>
<td>2180.0</td>
<td>0</td>
<td>20</td>
<td>1959.0</td>
<td>NaN</td>
<td>2020</td>
<td>5</td>
<td>Standard</td>
<td>61.0</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18050893</td>
<td>24504270</td>
<td>Menendez Hernandez, Jose</td>
<td>ESP</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1929.0</td>
<td>0</td>
<td>20</td>
<td>2000.0</td>
<td>i</td>
<td>2021</td>
<td>3</td>
<td>Standard</td>
<td>21.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10050788</td>
<td>35041118</td>
<td>Alim Khan</td>
<td>IND</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1523.0</td>
<td>0</td>
<td>40</td>
<td>1992.0</td>
<td>NaN</td>
<td>2019</td>
<td>5</td>
<td>Standard</td>
<td>27.0</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18388934</td>
<td>14913216</td>
<td>Lelkes, Oliver</td>
<td>SVK</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1922.0</td>
<td>0</td>
<td>20</td>
<td>1990.0</td>
<td>NaN</td>
<td>2021</td>
<td>4</td>
<td>Standard</td>
<td>31.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9088412</td>
<td>806862</td>
<td>Bonanzinga, Corrado</td>
<td>ITA</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2060.0</td>
<td>0</td>
<td>20</td>
<td>1962.0</td>
<td>i</td>
<td>2019</td>
<td>2</td>
<td>Standard</td>
<td>57.0</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16397513</td>
<td>116823</td>
<td>Acosta, German</td>
<td>ARG</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1826.0</td>
<td>0</td>
<td>40</td>
<td>1989.0</td>
<td>NaN</td>
<td>2020</td>
<td>11</td>
<td>Standard</td>
<td>31.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19940020</td>
<td>4405692</td>
<td>Ramirez Arias, Jorge Alonso</td>
<td>COL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1921.0</td>
<td>0</td>
<td>20</td>
<td>1967.0</td>
<td>NaN</td>
<td>2021</td>
<td>8</td>
<td>Standard</td>
<td>54.0</td>
<td>3</td>
</tr>
</tbody>
</table>

<p>209679 rows × 18 columns</p>
</div>
</div>
</div>
<p>The preprocessed data is used to fit a K-Means clustering model. The model aims to partition the data into 5 clusters based on the similarities in player features like ‘Rat’, ‘Gms’, and ‘Age’. Once the model is fitted, each player in the sample is assigned to one of the five clusters.</p>
<p>After clustering, this code aggregates the data to find the mean of each numeric feature within each cluster. The aggregation is done by grouping the data by the <code>Cluster</code> column and calculating the mean for <code>Rat</code>, <code>Gms</code>, and <code>Age</code>. This step is essential for interpreting what each cluster represents in terms of player attributes.</p>
<div class="cell" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only numeric columns for aggregation</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> sampled_data.select_dtypes(include<span class="op">=</span>[<span class="st">'int64'</span>, <span class="st">'float64'</span>])</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the 'Cluster' column for grouping</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>numeric_cols[<span class="st">'Cluster'</span>] <span class="op">=</span> sampled_data[<span class="st">'Cluster'</span>]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by 'Cluster' and calculate mean for numeric columns only</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>cluster_means <span class="op">=</span> numeric_cols.groupby(<span class="st">'Cluster'</span>).mean()</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>cluster_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID Number</th>
<th data-quarto-table-cell-role="th">Rat</th>
<th data-quarto-table-cell-role="th">Gms</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">B-day</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Mon</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Cluster</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.211717e+07</td>
<td>1855.710673</td>
<td>0.092418</td>
<td>28.888650</td>
<td>1991.386313</td>
<td>2019.996328</td>
<td>6.614028</td>
<td>28.610016</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.851938e+07</td>
<td>1542.785591</td>
<td>0.138683</td>
<td>30.453221</td>
<td>1959.481303</td>
<td>2020.180078</td>
<td>6.631916</td>
<td>60.698775</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.756030e+07</td>
<td>1288.811085</td>
<td>0.103030</td>
<td>37.709401</td>
<td>2000.856160</td>
<td>2020.173328</td>
<td>6.683125</td>
<td>19.317167</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>6.814007e+06</td>
<td>2062.311710</td>
<td>0.125758</td>
<td>24.497590</td>
<td>1963.489532</td>
<td>2020.005780</td>
<td>6.573155</td>
<td>56.516247</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2.156193e+07</td>
<td>1701.469971</td>
<td>8.473169</td>
<td>29.991006</td>
<td>1989.213351</td>
<td>2019.632357</td>
<td>6.689917</td>
<td>30.419007</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The table shows the mean values for different attributes across the 5 clusters that were identified during the clustering process. Here’s an analysis of what the data suggests about each cluster:</p>
<section id="cluster-0" class="level3">
<h3 class="anchored" data-anchor-id="cluster-0">Cluster 0:</h3>
<ul>
<li><strong>ID Number</strong>: The ID numbers seem to be an arbitrary identifier and don’t provide much insight into the cluster.</li>
<li><strong>Rat (Rating)</strong>: The average rating is around 1855, which might suggest this cluster consists of intermediate to advanced players.</li>
<li><strong>Gms (Games Played per Month)</strong>: The average number of games played per month is very low, suggesting these players are not very active.</li>
<li><strong>B-day (Birth Year)</strong>: The average birth year is 1991, making the average age of players in this cluster around 28 years.</li>
<li><strong>Year and Mon</strong>: These seem to be averages of the dataset’s recording time and don’t provide cluster-specific insights.</li>
<li><strong>Age</strong>: The average age is about 28 years, indicating a group of young adult players.</li>
</ul>
</section>
<section id="cluster-1" class="level3">
<h3 class="anchored" data-anchor-id="cluster-1">Cluster 1:</h3>
<ul>
<li><strong>Rat (Rating)</strong>: The average rating here is lower at about 1542, which could indicate that this cluster is made up of beginners to intermediate players.</li>
<li><strong>Gms (Games Played per Month)</strong>: A slightly higher game frequency than Cluster 0.</li>
<li><strong>B-day (Birth Year)</strong>: The players in this cluster are on average older with a birth year around 1959, making the average age approximately 61 years.</li>
<li><strong>Age</strong>: The players in this cluster are older, suggesting a possible group of veteran or more experienced players in terms of age, not necessarily rating.</li>
</ul>
</section>
<section id="cluster-2" class="level3">
<h3 class="anchored" data-anchor-id="cluster-2">Cluster 2:</h3>
<ul>
<li><strong>Rat (Rating)</strong>: The lowest average rating in this group, around 1288, possibly indicates that these players are beginners or less competitive.</li>
<li><strong>Gms (Games Played per Month)</strong>: Similar low activity in terms of games played.</li>
<li><strong>B-day (Birth Year)</strong>: This cluster has the youngest players with an average birth year around 2000, indicating these are likely young or junior players.</li>
<li><strong>Age</strong>: Reflecting the birth year, the average age is about 19 years.</li>
</ul>
</section>
<section id="cluster-3" class="level3">
<h3 class="anchored" data-anchor-id="cluster-3">Cluster 3:</h3>
<ul>
<li><strong>Rat (Rating)</strong>: The highest average rating of about 2062, suggesting these are advanced or possibly professional players.</li>
<li><strong>Gms (Games Played per Month)</strong>: Comparable low activity to Clusters 0 and 2.</li>
<li><strong>B-day (Birth Year)</strong>: Older players, with an average birth year around 1963.</li>
<li><strong>Age</strong>: The average age is about 56 years, which suggests they might be experienced players who have been active in chess for a longer time.</li>
</ul>
</section>
<section id="cluster-4" class="level3">
<h3 class="anchored" data-anchor-id="cluster-4">Cluster 4:</h3>
<ul>
<li><strong>Rat (Rating)</strong>: An average rating of about 1701, indicating a mix of intermediate and potentially advancing players.</li>
<li><strong>Gms (Games Played per Month)</strong>: Significantly higher activity with an average of about 8.47 games per month.</li>
<li><strong>B-day (Birth Year)</strong>: Players in this cluster are also relatively young, with an average birth year around 1989.</li>
<li><strong>Age</strong>: The average age is about 30 years, and the high activity level may indicate these are serious or semi-professional players who regularly compete.</li>
</ul>
<div class="cell" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduce dimensions</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>reduced_data <span class="op">=</span> pca.fit_transform(sampled_data[numeric_features])</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of the reduced data</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(reduced_data[:, <span class="dv">0</span>], reduced_data[:, <span class="dv">1</span>], c<span class="op">=</span>sampled_data[<span class="st">'Cluster'</span>], cmap<span class="op">=</span><span class="st">'viridis'</span>, label<span class="op">=</span>sampled_data[<span class="st">'Cluster'</span>])</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'PCA Feature 1'</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'PCA Feature 2'</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Chess Player Clusters Visualization'</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>plt.colorbar(label<span class="op">=</span><span class="st">'Cluster'</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-33-output-1.png" width="652" height="523"></p>
</div>
</div>
<p>Here’s what we can infer from the visualization:</p>
<ol type="1">
<li><p><strong>Cluster Distribution</strong>: The colors represent different clusters. The plot shows how the clusters are distributed in the reduced two-dimensional space. Each color corresponds to a different cluster assigned by the K-Means algorithm.</p></li>
<li><p><strong>Cluster Separation</strong>: Almost all clusters appear to be well-separated, while others (Yellow) overlap. Well-separated clusters suggest that there are distinct groups of players with significant differences in their characteristics. Overlapping clusters might indicate that the differences between some groups of players are more nuanced.</p></li>
<li><p><strong>Density and Outliers</strong>: The density of points within each cluster varies. Some clusters are more densely packed, meaning that there are many players with similar characteristics. Sparse areas or outliers could represent players with unique attributes not common in their cluster or players that do not fit well into any of the clusters.</p></li>
<li><p><strong>Principal Component Analysis (PCA)</strong>:</p>
<ul>
<li><strong>PCA Feature 1</strong> seems to be the most significant axis, as it shows a clear separation between clusters, which suggests it captures the most variance in the data.</li>
<li><strong>PCA Feature 2</strong> shows a less pronounced, but still noticeable, separation vertically.</li>
</ul></li>
<li><p><strong>Data Spread</strong>: The spread of data points along the PCA features indicates the variance in the dataset. A wide spread along any PCA feature suggests greater variance in the player characteristics corresponding to that principal component.</p></li>
</ol>
<p>The color bar on the right side indicates the cluster number, which ranges from 0 to 4, as you have five clusters in total. Each cluster’s relative position and spread can potentially tell us about the underlying structure of the chess player data:</p>
<ul>
<li>Players in clusters that are closer to each other might share more similarities.</li>
<li>Players in more distant clusters might be different in more significant ways.</li>
</ul>
</section>
</section>
<section id="rating-dynamics-trend-analysis" class="level2">
<h2 class="anchored" data-anchor-id="rating-dynamics-trend-analysis">Rating Dynamics (Trend analysis)</h2>
<p>Since we have a large datasets, let’s only focus on mean of top 10 countries.</p>
<div class="cell" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'all_chess_data' contains your complete dataset</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for standard games</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>standard_games_data <span class="op">=</span> all_chess_data[all_chess_data[<span class="st">'Game Mode'</span>] <span class="op">==</span> <span class="st">'Standard'</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifying top 10 countries based on player count</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>top_countries <span class="op">=</span> standard_games_data[<span class="st">'Fed'</span>].value_counts().head(<span class="dv">10</span>).index.tolist()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for only top 10 countries</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>top_countries_data <span class="op">=</span> standard_games_data[standard_games_data[<span class="st">'Fed'</span>].isin(top_countries)]</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>top_countries_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID Number</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Fed</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Tit</th>
<th data-quarto-table-cell-role="th">WTit</th>
<th data-quarto-table-cell-role="th">OTit</th>
<th data-quarto-table-cell-role="th">FOA</th>
<th data-quarto-table-cell-role="th">Rat</th>
<th data-quarto-table-cell-role="th">Gms</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">B-day</th>
<th data-quarto-table-cell-role="th">Flag</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Mon</th>
<th data-quarto-table-cell-role="th">Game Mode</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4713827</td>
<td>35077023</td>
<td>A Chakravarthy</td>
<td>IND</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1151.0</td>
<td>0</td>
<td>40</td>
<td>1986.0</td>
<td>i</td>
<td>2017</td>
<td>12</td>
<td>Standard</td>
<td>31.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4713830</td>
<td>5045886</td>
<td>A K, Kalshyan</td>
<td>IND</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1841.0</td>
<td>0</td>
<td>20</td>
<td>1964.0</td>
<td>NaN</td>
<td>2017</td>
<td>12</td>
<td>Standard</td>
<td>53.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4713834</td>
<td>5080444</td>
<td>A, Sohita</td>
<td>IND</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1447.0</td>
<td>0</td>
<td>40</td>
<td>1995.0</td>
<td>wi</td>
<td>2017</td>
<td>12</td>
<td>Standard</td>
<td>22.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4713845</td>
<td>25682938</td>
<td>Aaazad G Acharya</td>
<td>IND</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1136.0</td>
<td>0</td>
<td>40</td>
<td>2004.0</td>
<td>NaN</td>
<td>2017</td>
<td>12</td>
<td>Standard</td>
<td>13.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4713846</td>
<td>24663832</td>
<td>Aab, Manfred</td>
<td>GER</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1706.0</td>
<td>0</td>
<td>20</td>
<td>1963.0</td>
<td>i</td>
<td>2017</td>
<td>12</td>
<td>Standard</td>
<td>54.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26209183</td>
<td>34190632</td>
<td>Zyubin, Sergey</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1884.0</td>
<td>0</td>
<td>40</td>
<td>1975.0</td>
<td>i</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
<td>47.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26209184</td>
<td>55746969</td>
<td>Zyuganov, Igor</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1325.0</td>
<td>10</td>
<td>40</td>
<td>2010.0</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
<td>12.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26209185</td>
<td>24232602</td>
<td>Zyuzev, Pavel</td>
<td>RUS</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1856.0</td>
<td>0</td>
<td>40</td>
<td>1993.0</td>
<td>i</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
<td>29.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26209186</td>
<td>1189980</td>
<td>Zywert, Kacper</td>
<td>POL</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1519.0</td>
<td>0</td>
<td>20</td>
<td>1999.0</td>
<td>NaN</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
<td>23.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26209187</td>
<td>21857814</td>
<td>Zyznowska, Marianna</td>
<td>POL</td>
<td>F</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1150.0</td>
<td>0</td>
<td>40</td>
<td>2004.0</td>
<td>wi</td>
<td>2022</td>
<td>12</td>
<td>Standard</td>
<td>18.0</td>
</tr>
</tbody>
</table>

<p>11400367 rows × 17 columns</p>
</div>
</div>
</div>
<section id="time-series-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="time-series-forecasting">Time Series Forecasting</h3>
<p>The code block bellow employs a sophisticated time series forecasting method using the <code>auto_arima</code> function to automatically determine the best <code>ARIMA</code> model parameters for each country’s data. This function is part of the <code>pmdarima</code> library, which simplifies the process of <code>ARIMA</code> model selection by conducting stepwise search across different combinations of parameters and selecting the one that best fits the historical data.</p>
<p>The forecasting model used is <code>SARIMAX</code> from the <code>statsmodels</code> library. <code>SARIMAX</code> stands for Seasonal AutoRegressive Integrated Moving Average with eXogenous regressors model. It is an extension of the <code>ARIMA</code> model that supports univariate time series data with a seasonal component.</p>
<div class="cell" data-execution_count="34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pmdarima <span class="im">import</span> auto_arima</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.statespace.sarimax <span class="im">import</span> SARIMAX</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define distinct colors for each country</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>distinct_colors <span class="op">=</span> [</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#e6194B'</span>, <span class="st">'#3cb44b'</span>, <span class="st">'#ffe119'</span>, <span class="st">'#4363d8'</span>, <span class="st">'#f58231'</span>, </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#911eb4'</span>, <span class="st">'#46f0f0'</span>, <span class="st">'#f032e6'</span>, <span class="st">'#bcf60c'</span>, <span class="st">'#fabebe'</span>, </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#008080'</span>, <span class="st">'#e6beff'</span>, <span class="st">'#9a6324'</span>, <span class="st">'#fffac8'</span>, <span class="st">'#800000'</span>, </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#aaffc3'</span>, <span class="st">'#808000'</span>, <span class="st">'#ffd8b1'</span>, <span class="st">'#000075'</span>, <span class="st">'#808080'</span>, <span class="st">'#ffffff'</span>, <span class="st">'#000000'</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'top_countries_data' is a DataFrame containing your chess data</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure 'Year' is of integer type for proper DateTime conversion</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>top_countries_data.loc[:, <span class="st">'Year'</span>] <span class="op">=</span> top_countries_data[<span class="st">'Year'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data to calculate average rating per year for top countries</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>yearly_avg_rating <span class="op">=</span> top_countries_data.groupby([<span class="st">'Year'</span>, <span class="st">'Fed'</span>])[<span class="st">'Rat'</span>].mean().unstack()</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the year index to a DateTimeIndex with annual frequency starting in January</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>yearly_avg_rating.index <span class="op">=</span> pd.to_datetime(yearly_avg_rating.index, <span class="bu">format</span><span class="op">=</span><span class="st">'%Y'</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>yearly_avg_rating.index.freq <span class="op">=</span> <span class="st">'AS-JAN'</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the plot</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize global min and max with actual data</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>global_min <span class="op">=</span> np.nanmin(yearly_avg_rating.values)</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>global_max <span class="op">=</span> np.nanmax(yearly_avg_rating.values)</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast and plot for each country</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, country <span class="kw">in</span> <span class="bu">enumerate</span>(yearly_avg_rating.columns):</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    country_ratings <span class="op">=</span> yearly_avg_rating[country].dropna()</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure there's enough data for ARIMA</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(country_ratings) <span class="op">&gt;=</span> <span class="dv">3</span>:</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Automatically discover the optimal order for the ARIMA model</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>            auto_model <span class="op">=</span> auto_arima(country_ratings, seasonal<span class="op">=</span><span class="va">False</span>, stepwise<span class="op">=</span><span class="va">True</span>, error_action<span class="op">=</span><span class="st">'ignore'</span>, suppress_warnings<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Fit the best ARIMA model</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>            order <span class="op">=</span> auto_model.order</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>            seasonal_order <span class="op">=</span> auto_model.seasonal_order</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> SARIMAX(country_ratings, order<span class="op">=</span>order, seasonal_order<span class="op">=</span>seasonal_order)</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>            model_fit <span class="op">=</span> model.fit(disp<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forecast the next 5 years</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>            forecast <span class="op">=</span> model_fit.get_forecast(steps<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>            forecast_index <span class="op">=</span> pd.date_range(start<span class="op">=</span>country_ratings.index[<span class="op">-</span><span class="dv">1</span>], periods<span class="op">=</span><span class="dv">6</span>, freq<span class="op">=</span><span class="st">'AS'</span>)[<span class="dv">1</span>:]</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>            forecast_mean <span class="op">=</span> forecast.predicted_mean</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Plot historical data</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>            plt.plot(country_ratings.index, country_ratings, color<span class="op">=</span>distinct_colors[idx <span class="op">%</span> <span class="bu">len</span>(distinct_colors)], marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>country<span class="sc">}</span><span class="ss"> - Historical'</span>)</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Plot forecasted data</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>            plt.plot(forecast_index, forecast_mean, color<span class="op">=</span>distinct_colors[idx <span class="op">%</span> <span class="bu">len</span>(distinct_colors)], linestyle<span class="op">=</span><span class="st">'--'</span>, marker<span class="op">=</span><span class="st">'x'</span>, label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>country<span class="sc">}</span><span class="ss"> - Forecast'</span>)</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Update global min and max based on forecast, if valid</span></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> np.isnan(forecast_mean).<span class="bu">any</span>():</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>                global_min <span class="op">=</span> <span class="bu">min</span>(global_min, forecast_mean.<span class="bu">min</span>())</span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>                global_max <span class="op">=</span> <span class="bu">max</span>(global_max, forecast_mean.<span class="bu">max</span>())</span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Could not model for </span><span class="sc">{</span>country<span class="sc">}</span><span class="ss"> due to: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if global min and max are valid before setting axis limits</span></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> np.isfinite(global_min) <span class="kw">and</span> np.isfinite(global_max):</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>    plt.ylim(global_min <span class="op">-</span> <span class="dv">50</span>, global_max <span class="op">+</span> <span class="dv">50</span>)</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Rating Forecast for Top 10 Countries'</span>)</span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Rating'</span>)</span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>, ncol<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Chess%20ratings%20report_files/figure-html/cell-35-output-1.png" width="1411" height="819"></p>
</div>
</div>
<p>The plot presents the historical and forecasted average chess ratings for the top 10 countries as identified in your dataset. The historical data is marked by solid lines with circular markers, while the forecasted data extends from the last historical point in dashed lines with <code>x</code> markers, for the next five years.</p>
<p>Observations from the Forecast Plot: <strong>Trend</strong>: The majority of the countries show a declining trend in their forecasted average chess ratings. This might suggest that the model anticipates a decrease in performance or rating inflation over time.</p>
<p><strong>Rating Range</strong>: The ratings span a range from approximately 1300 to 1900. Countries with ratings at the upper end of this spectrum can be considered to have a stronger chess presence and higher-performing players on average.</p>
<p><strong>Top Performers</strong>: Based on historical data, countries like Russia (RUS) and Germany (GER) demonstrate higher average ratings, indicating robust chess communities and possibly better training infrastructure or resources.</p>
<p><strong>Forecast Variability</strong>: The forecasts show varying degrees of decline. For instance, the Czech Republic (CZE) and Spain (ESP) show a gentle decline, while countries like Iran (IRN) and Turkey (TUR) exhibit a sharper drop. This variability may stem from different factors influencing chess in each country.</p>
<p><strong>Implications of the Forecast</strong>: The declining trend across most countries could be a cause for concern for international chess federations.</p>
</section>
</section>
</section>
<section id="conclusion-and-recommendations" class="level1">
<h1>Conclusion and Recommendations</h1>
<p>The analysis of chess player’s ratings, games, and geographic distributions provides valuable insights into the global chess landscape from 2017 to 2022. This report has identified key trends, patterns, and implications that can inform strategic decisions and initiatives in the chess community. Here are the conclusions and recommendations based on the findings:</p>
<section id="key-findings" class="level2">
<h2 class="anchored" data-anchor-id="key-findings">Key Findings</h2>
<ol type="1">
<li><p><strong>Rating Distribution Among Titles</strong>: The analysis of player ratings across different titles shows a clear stratification, with higher titles generally corresponding to higher ratings. This underscores the effectiveness of the rating system in reflecting skill levels.</p></li>
<li><p><strong>Geographic Distribution and Performance</strong>: Europe and Asia dominate the chess scene with strong player bases. North America, while having fewer players, shows a higher average rating, indicating a stronger competitive scene.</p></li>
<li><p><strong>COVID-19 Impact</strong>: The pandemic significantly impacted the number of games played and player ratings, with a noticeable decline during the pandemic years. However, a recovery trend is evident in 2022.</p></li>
<li><p><strong>Player Segmentation</strong>: Clustering revealed distinct groups of players, varying in skill level, activity, and age. This segmentation can be utilized for targeted development programs and marketing strategies.</p></li>
<li><p><strong>Performance Predictions</strong>: The time series forecasting for top countries indicates a general declining trend in average ratings, suggesting potential challenges in maintaining or improving chess standards globally.</p></li>
</ol>
</section>
<section id="recommendations" class="level2">
<h2 class="anchored" data-anchor-id="recommendations">Recommendations</h2>
<ol type="1">
<li><p><strong>Developing Talent Across Age Groups</strong>: Focusing on nurturing talent in younger age groups, as indicated by the clustering analysis, can help build a strong future player base. Older players, with their experience, can be engaged in mentorship roles.</p></li>
<li><p><strong>Addressing Geographic Disparities</strong>: Initiatives to strengthen chess in countries with lower average ratings or declining trends could involve increased investment in chess education, tournaments.</p></li>
<li><p><strong>Responding to COVID-19 Impact</strong>: To recover from the pandemic’s impact, increased promotion of both online and offline chess events, coupled with player support programs, could revitalize interest and participation.</p></li>
<li><p><strong>Exploiting Data for Strategic Decisions</strong>: The insights from data analysis should guide policy-making and strategic decisions in chess federations. Regular data analysis can help track progress, identify emerging trends, and make informed decisions.</p></li>
<li><p><strong>Enhanced Training Programs</strong>: Based on the player segmentation, customized training programs can be developed to cater to the specific needs of different player groups.</p></li>
<li><p><strong>Publicity and Marketing</strong>: Utilizing the data to target specific demographics and regions with tailored marketing strategies can increase chess’s popularity and participation rates.</p></li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>